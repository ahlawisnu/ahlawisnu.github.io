<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nature JSON Tree Builder - Material Design 3</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Flex:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet">
    <style>
       :root {
            /* Hatsune Miku Color Palette - Light Theme */
            /* Primary: Miku Teal/Cyan #39C5BB */
            --md-sys-color-primary: #39C5BB;
            --md-sys-color-on-primary: #003735;
            --md-sys-color-primary-container: #A6F4EF;
            --md-sys-color-on-primary-container: #00201E;
            
            /* Secondary: Soft Teal */
            --md-sys-color-secondary: #4A6361;
            --md-sys-color-on-secondary: #FFFFFF;
            --md-sys-color-secondary-container: #CCE8E5;
            --md-sys-color-on-secondary-container: #051F1D;
            
            /* Tertiary: Miku Hair Blue */
            --md-sys-color-tertiary: #0066CC;
            --md-sys-color-on-tertiary: #FFFFFF;
            --md-sys-color-tertiary-container: #D1E4FF;
            --md-sys-color-on-tertiary-container: #001D36;
            
            /* Surface Colors - Cool Gray with Teal Tint */
            --md-sys-color-surface: #FAFDFC;
            --md-sys-color-on-surface: #161D1C;
            --md-sys-color-surface-variant: #DAE5E3;
            --md-sys-color-on-surface-variant: #3F4948;
            
            /* Outline Colors */
            --md-sys-color-outline: #6F7978;
            --md-sys-color-outline-variant: #BEC9C7;
            
            /* Error Colors */
            --md-sys-color-error: #BA1A1A;
            --md-sys-color-error-container: #FFDAD6;
            --md-sys-color-on-error: #FFFFFF;
            
            /* Surface Tints */
            --md-sys-color-surface-tint: #39C5BB;
            --md-sys-color-surface-1: #F0F9F8;
            --md-sys-color-surface-2: #E8F6F5;
            --md-sys-color-surface-3: #E0F3F2;
            --md-sys-color-surface-4: #D8F0EF;
            --md-sys-color-surface-5: #D0EDEC;
            
            --tree-line-color: var(--md-sys-color-outline-variant);
            --tree-hover: var(--md-sys-color-surface-2);
            
            /* Miku Accent Colors */
            --miku-hair: #39C5BB;
            --miku-hair-dark: #2DA8A0;
            --miku-hair-light: #5DDCD3;
            --miku-tie: #FF4081;
            --miku-tie-light: #FF79B0;
            --miku-sleeve: #E0F7FA;
            
            --md-sys-spacing-1: 4px;
            --md-sys-spacing-2: 8px;
            --md-sys-spacing-3: 12px;
            --md-sys-spacing-4: 16px;
            --md-sys-spacing-5: 20px;
            --md-sys-spacing-6: 24px;
            --md-sys-spacing-8: 32px;
            --md-sys-spacing-12: 48px;
            
            --md-sys-shape-corner-none: 0px;
            --md-sys-shape-corner-extra-small: 4px;
            --md-sys-shape-corner-small: 8px;
            --md-sys-shape-corner-medium: 12px;
            --md-sys-shape-corner-large: 16px;
            --md-sys-shape-corner-extra-large: 28px;
            --md-sys-shape-corner-full: 50%;
            
            --md-sys-typescale-display-large: 400 3.5rem/4rem 'Roboto Flex';
            --md-sys-typescale-display-medium: 400 2.8rem/3.2rem 'Roboto Flex';
            --md-sys-typescale-headline-large: 400 2rem/2.5rem 'Roboto Flex';
            --md-sys-typescale-headline-medium: 400 1.75rem/2.25rem 'Roboto Flex';
            --md-sys-typescale-title-large: 400 1.375rem/1.75rem 'Roboto Flex';
            --md-sys-typescale-title-medium: 500 1rem/1.5rem 'Roboto Flex';
            --md-sys-typescale-body-large: 400 1rem/1.5rem 'Roboto Flex';
            --md-sys-typescale-body-medium: 400 0.875rem/1.25rem 'Roboto Flex';
            --md-sys-typescale-label-large: 500 0.875rem/1.25rem 'Roboto Flex';
            --md-sys-typescale-label-medium: 500 0.75rem/1rem 'Roboto Flex';
            
            --md-sys-motion-duration-short: 150ms;
            --md-sys-motion-duration-medium: 300ms;
            --md-sys-motion-duration-long: 500ms;
            --md-sys-motion-easing-standard: cubic-bezier(0.2, 0, 0, 1);
            --md-sys-motion-easing-emphasized: cubic-bezier(0.2, 0, 0, 1);
        }

        [data-theme="dark"] {
            /* Hatsune Miku Color Palette - Dark Theme */
            --md-sys-color-primary: #39C5BB;
            --md-sys-color-on-primary: #003735;
            --md-sys-color-primary-container: #00504C;
            --md-sys-color-on-primary-container: #A6F4EF;
            
            --md-sys-color-secondary: #B1CCC9;
            --md-sys-color-on-secondary: #1C3533;
            --md-sys-color-secondary-container: #334B49;
            --md-sys-color-on-secondary-container: #CCE8E5;
            
            --md-sys-color-tertiary: #9ECAFF;
            --md-sys-color-on-tertiary: #003258;
            --md-sys-color-tertiary-container: #00497D;
            --md-sys-color-on-tertiary-container: #D1E4FF;
            
            --md-sys-color-surface: #0F1514;
            --md-sys-color-on-surface: #DDE4E3;
            --md-sys-color-surface-variant: #3F4948;
            --md-sys-color-on-surface-variant: #BEC9C7;
            
            --md-sys-color-outline: #899391;
            --md-sys-color-outline-variant: #3F4948;
            
            --md-sys-color-error: #FFB4AB;
            --md-sys-color-error-container: #93000A;
            
            --md-sys-color-surface-tint: #39C5BB;
            --md-sys-color-surface-1: #14201F;
            --md-sys-color-surface-2: #192624;
            --md-sys-color-surface-3: #1E2C2A;
            --md-sys-color-surface-4: #223230;
            --md-sys-color-surface-5: #273836;
            
            --tree-line-color: #3F4948;
            --tree-hover: #1C3533;
        }


        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html {
            font-size: 16px;
        }

        @media (max-width: 768px) {
            html {
                font-size: 14px;
            }
        }

        body {
            font-family: 'Roboto Flex', sans-serif;
            background-color: var(--md-sys-color-surface);
            color: var(--md-sys-color-on-surface);
            min-height: 100vh;
            overflow-x: hidden;
            transition: background-color var(--md-sys-motion-duration-medium) var(--md-sys-motion-easing-standard);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .nature-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .leaf-ornament {
            position: absolute;
            opacity: 0.08;
            animation: float 20s ease-in-out infinite;
        }

        .leaf-1 {
            top: 10%;
            left: 5%;
            width: 120px;
            height: 120px;
            background: radial-gradient(circle at 30% 30%, var(--md-sys-color-primary), transparent 70%);
            border-radius: 0 70% 0 70%;
            transform: rotate(-45deg);
            animation-delay: 0s;
        }

        .leaf-2 {
            top: 60%;
            right: 10%;
            width: 80px;
            height: 80px;
            background: radial-gradient(circle at 30% 30%, var(--md-sys-color-tertiary), transparent 70%);
            border-radius: 0 60% 0 60%;
            transform: rotate(15deg);
            animation-delay: -5s;
        }

        .leaf-3 {
            bottom: 20%;
            left: 15%;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle at 40% 40%, var(--md-sys-color-secondary), transparent 70%);
            border-radius: 0 80% 0 50%;
            transform: rotate(45deg);
            animation-delay: -10s;
        }

        .circle-ornament {
            position: absolute;
            border-radius: 50%;
            opacity: 0.05;
            background: var(--md-sys-color-primary);
        }

        .circle-1 {
            width: 300px;
            height: 300px;
            top: -100px;
            right: -100px;
        }

        .circle-2 {
            width: 200px;
            height: 200px;
            bottom: -50px;
            left: -50px;
            background: var(--md-sys-color-tertiary);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(var(--rot, 0deg)); }
            50% { transform: translateY(-20px) rotate(calc(var(--rot, 0deg) + 5deg)); }
        }

        .app-container {
            position: relative;
            z-index: 1;
            max-width: 1400px;
            margin: 0 auto;
            padding: var(--md-sys-spacing-6);
        }

        @media (max-width: 768px) {
            .app-container {
                padding: var(--md-sys-spacing-3);
            }
        }

        .app-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--md-sys-spacing-4) var(--md-sys-spacing-6);
            background-color: var(--md-sys-color-surface);
            border-bottom: 1px solid var(--md-sys-color-outline-variant);
            margin: calc(-1 * var(--md-sys-spacing-6));
            margin-bottom: var(--md-sys-spacing-6);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
            background-color: rgba(var(--md-sys-color-surface), 0.8);
        }

        @media (max-width: 768px) {
            .app-bar {
                margin: calc(-1 * var(--md-sys-spacing-3));
                margin-bottom: var(--md-sys-spacing-3);
                padding: var(--md-sys-spacing-3);
            }
        }

        .app-bar-left {
            display: flex;
            align-items: center;
            gap: var(--md-sys-spacing-3);
        }

        @media (max-width: 480px) {
            .app-bar-left {
                gap: var(--md-sys-spacing-2);
            }
        }

        .logo {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--md-sys-color-primary-container), var(--md-sys-color-tertiary-container));
            border-radius: var(--md-sys-shape-corner-medium);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--md-sys-color-on-primary-container);
            font-variation-settings: 'FILL' 1, 'wght' 600;
            flex-shrink: 0;
        }

        @media (max-width: 480px) {
            .logo {
                width: 32px;
                height: 32px;
            }
        }

        .app-title {
            font: var(--md-sys-typescale-title-large);
            color: var(--md-sys-color-on-surface);
            font-weight: 600;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        @media (max-width: 768px) {
            .app-title {
                font: var(--md-sys-typescale-title-medium);
                max-width: 200px;
            }
        }

        @media (max-width: 480px) {
            .app-title {
                font: var(--md-sys-typescale-body-large);
                font-weight: 600;
                max-width: 150px;
            }
        }

        .app-bar-actions {
            display: flex;
            gap: var(--md-sys-spacing-2);
        }

        .main-layout {
            display: grid;
            grid-template-columns: 1fr 500px;
            gap: var(--md-sys-spacing-6);
            align-items: start;
        }

        @media (max-width: 1200px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .main-layout {
                gap: var(--md-sys-spacing-4);
            }
        }

        .card {
            background-color: var(--md-sys-color-surface-1);
            border-radius: var(--md-sys-shape-corner-large);
            padding: var(--md-sys-spacing-6);
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            transition: all var(--md-sys-motion-duration-medium) var(--md-sys-motion-easing-standard);
            border: 1px solid var(--md-sys-color-outline-variant);
        }

        @media (max-width: 768px) {
            .card {
                padding: var(--md-sys-spacing-4);
                border-radius: var(--md-sys-shape-corner-medium);
            }
        }

        @media (max-width: 480px) {
            .card {
                padding: var(--md-sys-spacing-3);
            }
        }

        .card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .card-title {
            font: var(--md-sys-typescale-title-medium);
            color: var(--md-sys-color-on-surface);
            margin-bottom: var(--md-sys-spacing-4);
            display: flex;
            align-items: center;
            gap: var(--md-sys-spacing-2);
            flex-wrap: wrap;
        }

        @media (max-width: 480px) {
            .card-title {
                font: var(--md-sys-typescale-body-large);
                font-weight: 600;
                margin-bottom: var(--md-sys-spacing-3);
            }
        }

        .card-subtitle {
            font: var(--md-sys-typescale-body-medium);
            color: var(--md-sys-color-on-surface-variant);
            margin-bottom: var(--md-sys-spacing-4);
        }

        @media (max-width: 480px) {
            .card-subtitle {
                font: var(--md-sys-typescale-body-medium);
                margin-bottom: var(--md-sys-spacing-3);
            }
        }

        .tree-container, .article-field-container {
            background-color: var(--md-sys-color-surface);
            border-radius: var(--md-sys-shape-corner-medium);
            border: 1px solid var(--md-sys-color-outline-variant);
            overflow: hidden;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .tree-node, .article-field-node {
            position: relative;
            min-width: fit-content;
        }

        .tree-node-content, .article-field-content {
            display: flex;
            align-items: center;
            gap: var(--md-sys-spacing-2);
            padding: var(--md-sys-spacing-3) var(--md-sys-spacing-4);
            border-bottom: 1px solid var(--md-sys-color-outline-variant);
            transition: background-color var(--md-sys-motion-duration-short);
            position: relative;
            min-width: fit-content;
        }

        @media (max-width: 768px) {
            .tree-node-content, .article-field-content {
                padding: var(--md-sys-spacing-2) var(--md-sys-spacing-3);
                gap: var(--md-sys-spacing-1);
            }
        }

        .tree-node-content:hover, .article-field-content:hover {
            background-color: var(--tree-hover);
        }

        .tree-node-content.dragging, .article-field-content.dragging {
            opacity: 0.5;
            background-color: var(--md-sys-color-primary-container);
        }

        .tree-node-content.drag-over, .article-field-content.drag-over {
            border-top: 3px solid var(--md-sys-color-primary);
        }

        .tree-indent, .field-indent {
            display: flex;
            align-items: center;
            gap: var(--md-sys-spacing-1);
            flex-shrink: 0;
        }

        .tree-line, .field-line {
            width: 16px;
            height: 20px;
            position: relative;
            flex-shrink: 0;
        }

        @media (max-width: 480px) {
            .tree-line, .field-line {
                width: 12px;
            }
        }

        .tree-line::before, .field-line::before {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 1px;
            background-color: var(--tree-line-color);
        }

        .tree-line::after, .field-line::after {
            content: '';
            position: absolute;
            left: 50%;
            top: 50%;
            right: 0;
            height: 1px;
            background-color: var(--tree-line-color);
        }

        .tree-line.last::before, .field-line.last::before {
            bottom: 50%;
        }

        .tree-toggle, .field-toggle {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border-radius: var(--md-sys-shape-corner-small);
            color: var(--md-sys-color-on-surface-variant);
            transition: all var(--md-sys-motion-duration-short);
            z-index: 2;
            background-color: var(--md-sys-color-surface);
            border: 1px solid var(--md-sys-color-outline-variant);
            flex-shrink: 0;
        }

        .tree-toggle:hover, .field-toggle:hover {
            background-color: var(--md-sys-color-primary-container);
            color: var(--md-sys-color-primary);
        }

        .tree-toggle.expanded, .field-toggle.expanded {
            transform: rotate(90deg);
        }

        .tree-toggle.leaf, .field-toggle.leaf {
            visibility: hidden;
            pointer-events: none;
        }

        .drag-handle, .field-drag-handle {
            color: var(--md-sys-color-outline);
            cursor: grab;
            user-select: none;
            padding: var(--md-sys-spacing-1);
            border-radius: var(--md-sys-shape-corner-small);
            transition: all var(--md-sys-motion-duration-short);
            flex-shrink: 0;
            touch-action: none;
        }

        @media (max-width: 768px) {
            .drag-handle, .field-drag-handle {
                padding: var(--md-sys-spacing-1);
            }
            
            .drag-handle .material-symbols-rounded,
            .field-drag-handle .material-symbols-rounded {
                font-size: 16px !important;
            }
        }

        .drag-handle:hover, .field-drag-handle:hover {
            background-color: var(--md-sys-color-surface-variant);
            color: var(--md-sys-color-on-surface);
        }

        .drag-handle:active, .field-drag-handle:active {
            cursor: grabbing;
        }

        .tree-icon, .field-icon {
            color: var(--md-sys-color-primary);
            font-variation-settings: 'FILL' 1;
            flex-shrink: 0;
        }

        @media (max-width: 768px) {
            .tree-icon, .field-icon {
                font-size: 18px !important;
            }
        }

        .tree-icon.object, .field-icon.object {
            color: var(--md-sys-color-tertiary);
        }

        .tree-icon.array, .field-icon.array {
            color: var(--md-sys-color-secondary);
        }

        .tree-inputs, .field-inputs {
            flex: 1;
            display: flex;
            gap: var(--md-sys-spacing-2);
            align-items: center;
            min-width: 0;
        }

        @media (max-width: 768px) {
            .tree-inputs, .field-inputs {
                flex-wrap: wrap;
                gap: var(--md-sys-spacing-1);
            }
        }

        .tree-key-input, .field-key-input {
            flex: 1;
            min-width: 100px;
            max-width: 200px;
            padding: var(--md-sys-spacing-2) var(--md-sys-spacing-3);
            border: 1px solid var(--md-sys-color-outline);
            border-radius: var(--md-sys-shape-corner-small);
            background-color: var(--md-sys-color-surface);
            color: var(--md-sys-color-on-surface);
            font: var(--md-sys-typescale-body-medium);
            outline: none;
            transition: all var(--md-sys-motion-duration-short);
        }

        @media (max-width: 768px) {
            .tree-key-input, .field-key-input {
                min-width: 80px;
                max-width: 150px;
                font: var(--md-sys-typescale-body-medium);
                padding: var(--md-sys-spacing-2);
            }
        }

        @media (max-width: 480px) {
            .tree-key-input, .field-key-input {
                min-width: 60px;
                max-width: 120px;
                font-size: 0.875rem;
            }
        }

        .tree-key-input:focus, .field-key-input:focus {
            border-color: var(--md-sys-color-primary);
            box-shadow: 0 0 0 2px var(--md-sys-color-primary-container);
        }

        .tree-value-input, .field-value-input {
            flex: 2;
            min-width: 150px;
            padding: var(--md-sys-spacing-2) var(--md-sys-spacing-3);
            border: 1px solid var(--md-sys-color-outline);
            border-radius: var(--md-sys-shape-corner-small);
            background-color: var(--md-sys-color-surface);
            color: var(--md-sys-color-on-surface);
            font: var(--md-sys-typescale-body-medium);
            outline: none;
            transition: all var(--md-sys-motion-duration-short);
        }

        @media (max-width: 768px) {
            .tree-value-input, .field-value-input {
                min-width: 100px;
                font: var(--md-sys-typescale-body-medium);
                padding: var(--md-sys-spacing-2);
            }
        }

        @media (max-width: 480px) {
            .tree-value-input, .field-value-input {
                min-width: 80px;
                font-size: 0.875rem;
            }
        }

        .tree-value-input:focus, .field-value-input:focus {
            border-color: var(--md-sys-color-primary);
            box-shadow: 0 0 0 2px var(--md-sys-color-primary-container);
        }

        .tree-value-input:disabled,
        .tree-value-input.object-mode,
        .field-value-input:disabled,
        .field-value-input.object-mode {
            background-color: var(--md-sys-color-surface-variant);
            color: var(--md-sys-color-on-surface-variant);
            font-style: italic;
            cursor: not-allowed;
        }

        .tree-type-select, .field-type-select {
            padding: var(--md-sys-spacing-2) var(--md-sys-spacing-3);
            border: 1px solid var(--md-sys-color-outline);
            border-radius: var(--md-sys-shape-corner-small);
            background-color: var(--md-sys-color-surface);
            color: var(--md-sys-color-on-surface);
            font: var(--md-sys-typescale-body-medium);
            cursor: pointer;
            outline: none;
            min-width: 90px;
            flex-shrink: 0;
        }

        @media (max-width: 768px) {
            .tree-type-select, .field-type-select {
                min-width: 80px;
                font: var(--md-sys-typescale-body-medium);
                padding: var(--md-sys-spacing-2);
            }
        }

        @media (max-width: 480px) {
            .tree-type-select, .field-type-select {
                min-width: 70px;
                font-size: 0.875rem;
            }
        }

        .tree-type-select:focus, .field-type-select:focus {
            border-color: var(--md-sys-color-primary);
            box-shadow: 0 0 0 2px var(--md-sys-color-primary-container);
        }

        .tree-actions, .field-actions {
            display: flex;
            gap: var(--md-sys-spacing-1);
            flex-shrink: 0;
        }

        @media (max-width: 768px) {
            .tree-actions, .field-actions {
                gap: 2px;
            }
        }

        .icon-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: transparent;
            color: var(--md-sys-color-on-surface-variant);
            border-radius: var(--md-sys-shape-corner-full);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--md-sys-motion-duration-short);
            font-variation-settings: 'FILL' 0, 'wght' 400;
            flex-shrink: 0;
        }

        @media (max-width: 768px) {
            .icon-btn {
                width: 28px;
                height: 28px;
            }
            
            .icon-btn .material-symbols-rounded {
                font-size: 18px !important;
            }
        }

        .icon-btn:hover {
            background-color: var(--md-sys-color-surface-variant);
            color: var(--md-sys-color-on-surface);
        }

        .icon-btn.delete:hover {
            background-color: var(--md-sys-color-error-container);
            color: var(--md-sys-color-error);
        }

        .icon-btn.add-child:hover {
            background-color: var(--md-sys-color-primary-container);
            color: var(--md-sys-color-primary);
        }

        .icon-btn.copy:hover {
            background-color: var(--md-sys-color-secondary-container);
            color: var(--md-sys-color-on-secondary-container);
        }

        .tree-children, .field-children {
            position: relative;
            background-color: var(--md-sys-color-surface-1);
        }

        .tree-children.collapsed, .field-children.collapsed {
            display: none;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--md-sys-spacing-2);
            padding: var(--md-sys-spacing-3) var(--md-sys-spacing-5);
            border: none;
            border-radius: var(--md-sys-shape-corner-full);
            font: var(--md-sys-typescale-label-large);
            cursor: pointer;
            transition: all var(--md-sys-motion-duration-short);
            text-transform: none;
            letter-spacing: 0.025em;
            position: relative;
            overflow: hidden;
            white-space: nowrap;
        }

        @media (max-width: 768px) {
            .btn {
                padding: var(--md-sys-spacing-2) var(--md-sys-spacing-4);
                font: var(--md-sys-typescale-label-medium);
            }
        }

        @media (max-width: 480px) {
            .btn {
                padding: var(--md-sys-spacing-2) var(--md-sys-spacing-3);
                font: var(--md-sys-typescale-label-medium);
                gap: var(--md-sys-spacing-1);
            }
            
            .btn .material-symbols-rounded {
                font-size: 18px !important;
            }
        }

        .btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:active::after {
            width: 300px;
            height: 300px;
        }

        .btn-filled {
            background-color: var(--md-sys-color-primary);
            color: var(--md-sys-color-on-primary);
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }

        .btn-filled:hover {
            background-color: color-mix(in srgb, var(--md-sys-color-primary) 90%, black);
            box-shadow: 0 2px 6px rgba(0,0,0,0.4);
            transform: translateY(-1px);
        }

        .btn-tonal {
            background-color: var(--md-sys-color-secondary-container);
            color: var(--md-sys-color-on-secondary-container);
        }

        .btn-tonal:hover {
            background-color: color-mix(in srgb, var(--md-sys-color-secondary-container) 90%, black);
        }

        .btn-outlined {
            background-color: transparent;
            color: var(--md-sys-color-primary);
            border: 1px solid var(--md-sys-color-outline);
        }

        .btn-outlined:hover {
            background-color: var(--md-sys-color-primary-container);
            border-color: var(--md-sys-color-primary);
        }

        .btn-text {
            background-color: transparent;
            color: var(--md-sys-color-primary);
            padding: var(--md-sys-spacing-2) var(--md-sys-spacing-3);
        }

        .btn-text:hover {
            background-color: var(--md-sys-color-primary-container);
        }

        .output-section {
            position: sticky;
            top: 100px;
        }

        @media (max-width: 1200px) {
            .output-section {
                position: relative;
                top: 0;
            }
        }

        .output-card {
            background-color: var(--md-sys-color-surface-2);
        }

        .json-preview {
            background-color: var(--md-sys-color-surface);
            border: 1px solid var(--md-sys-color-outline-variant);
            border-radius: var(--md-sys-shape-corner-medium);
            padding: var(--md-sys-spacing-4);
            font-family: 'Roboto Mono', monospace;
            font-size: 0.875rem;
            line-height: 1.6;
            color: var(--md-sys-color-on-surface);
            overflow-x: auto;
            white-space: pre-wrap;
            word-break: break-word;
            max-height: 600px;
            overflow-y: auto;
            position: relative;
            -webkit-overflow-scrolling: touch;
        }

        @media (max-width: 768px) {
            .json-preview {
                padding: var(--md-sys-spacing-3);
                font-size: 0.75rem;
                max-height: 400px;
            }
        }

        @media (max-width: 480px) {
            .json-preview {
                padding: var(--md-sys-spacing-2);
                font-size: 0.7rem;
            }
        }

        .json-key {
            color: var(--md-sys-color-primary);
        }

        .json-string {
            color: var(--md-sys-color-tertiary);
        }

        .json-number {
            color: var(--md-sys-color-secondary);
        }

        .json-boolean {
            color: var(--md-sys-color-error);
        }

        .copy-btn {
            position: absolute;
            top: var(--md-sys-spacing-3);
            right: var(--md-sys-spacing-3);
            background-color: var(--md-sys-color-surface-1);
            border: 1px solid var(--md-sys-color-outline-variant);
            z-index: 10;
        }

        @media (max-width: 768px) {
            .copy-btn {
                top: var(--md-sys-spacing-2);
                right: var(--md-sys-spacing-2);
                width: 28px;
                height: 28px;
            }
        }

        .action-bar {
            display: flex;
            gap: var(--md-sys-spacing-2);
            margin-top: var(--md-sys-spacing-4);
            flex-wrap: wrap;
        }

        @media (max-width: 768px) {
            .action-bar {
                gap: var(--md-sys-spacing-2);
                margin-top: var(--md-sys-spacing-3);
            }
        }

        @media (max-width: 480px) {
            .action-bar {
                justify-content: stretch;
            }
            
            .action-bar .btn {
                flex: 1;
                min-width: calc(50% - var(--md-sys-spacing-1));
            }
        }

        .chip-group {
            display: flex;
            gap: var(--md-sys-spacing-2);
            flex-wrap: wrap;
            margin-bottom: var(--md-sys-spacing-4);
        }

        @media (max-width: 768px) {
            .chip-group {
                margin-bottom: var(--md-sys-spacing-3);
                gap: var(--md-sys-spacing-1);
            }
        }

        .chip {
            display: inline-flex;
            align-items: center;
            gap: var(--md-sys-spacing-2);
            padding: var(--md-sys-spacing-2) var(--md-sys-spacing-3);
            background-color: var(--md-sys-color-surface-variant);
            color: var(--md-sys-color-on-surface-variant);
            border-radius: var(--md-sys-shape-corner-small);
            font: var(--md-sys-typescale-label-medium);
            cursor: pointer;
            transition: all var(--md-sys-motion-duration-short);
            border: 1px solid transparent;
            white-space: nowrap;
        }

        @media (max-width: 480px) {
            .chip {
                padding: var(--md-sys-spacing-1) var(--md-sys-spacing-2);
                font: var(--md-sys-typescale-label-small);
            }
        }

        .chip:hover {
            background-color: var(--md-sys-color-secondary-container);
            color: var(--md-sys-color-on-secondary-container);
        }

        .chip.active {
            background-color: var(--md-sys-color-primary-container);
            color: var(--md-sys-color-on-primary-container);
            border-color: var(--md-sys-color-primary);
        }

        .snackbar {
            position: fixed;
            bottom: var(--md-sys-spacing-6);
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background-color: var(--md-sys-color-inverse-surface, #2d322b);
            color: var(--md-sys-color-inverse-on-surface, #f0f2eb);
            padding: var(--md-sys-spacing-4) var(--md-sys-spacing-6);
            border-radius: var(--md-sys-shape-corner-small);
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
            display: flex;
            align-items: center;
            gap: var(--md-sys-spacing-4);
            z-index: 1000;
            opacity: 0;
            transition: all var(--md-sys-motion-duration-medium) var(--md-sys-motion-easing-emphasized);
            max-width: 90vw;
            width: auto;
        }

        @media (max-width: 480px) {
            .snackbar {
                padding: var(--md-sys-spacing-3) var(--md-sys-spacing-4);
                font: var(--md-sys-typescale-body-medium);
                gap: var(--md-sys-spacing-2);
            }
        }

        .snackbar.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        .dialog-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all var(--md-sys-motion-duration-medium);
            backdrop-filter: blur(4px);
            padding: var(--md-sys-spacing-4);
        }

        .dialog-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .dialog {
            background-color: var(--md-sys-color-surface);
            border-radius: var(--md-sys-shape-corner-extra-large);
            padding: var(--md-sys-spacing-6);
            min-width: 320px;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.9);
            transition: transform var(--md-sys-motion-duration-medium);
            box-shadow: 0 8px 24px rgba(0,0,0,0.3);
            width: 100%;
        }

        @media (max-width: 768px) {
            .dialog {
                padding: var(--md-sys-spacing-4);
                min-width: unset;
            }
        }

        @media (max-width: 480px) {
            .dialog {
                padding: var(--md-sys-spacing-3);
                border-radius: var(--md-sys-shape-corner-large);
            }
        }

        .dialog-overlay.active .dialog {
            transform: scale(1);
        }

        .dialog-title {
            font: var(--md-sys-typescale-headline-small, 400 1.5rem/2rem 'Roboto Flex');
            color: var(--md-sys-color-on-surface);
            margin-bottom: var(--md-sys-spacing-4);
        }

        @media (max-width: 768px) {
            .dialog-title {
                font: var(--md-sys-typescale-title-large);
                margin-bottom: var(--md-sys-spacing-3);
            }
        }

        .dialog-content {
            font: var(--md-sys-typescale-body-medium);
            color: var(--md-sys-color-on-surface-variant);
            margin-bottom: var(--md-sys-spacing-6);
        }

        @media (max-width: 768px) {
            .dialog-content {
                font: var(--md-sys-typescale-body-medium);
                margin-bottom: var(--md-sys-spacing-4);
            }
        }

        .dialog-actions {
            display: flex;
            justify-content: flex-end;
            gap: var(--md-sys-spacing-2);
        }

        @media (max-width: 480px) {
            .dialog-actions {
                flex-direction: column-reverse;
            }
            
            .dialog-actions .btn {
                width: 100%;
                justify-content: center;
            }
        }

        .empty-state {
            text-align: center;
            padding: var(--md-sys-spacing-12) var(--md-sys-spacing-6);
            color: var(--md-sys-color-on-surface-variant);
        }

        @media (max-width: 768px) {
            .empty-state {
                padding: var(--md-sys-spacing-8) var(--md-sys-spacing-4);
            }
        }

        @media (max-width: 480px) {
            .empty-state {
                padding: var(--md-sys-spacing-6) var(--md-sys-spacing-3);
            }
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: var(--md-sys-spacing-4);
            opacity: 0.5;
        }

        @media (max-width: 768px) {
            .empty-state-icon {
                font-size: 36px;
                margin-bottom: var(--md-sys-spacing-3);
            }
        }

        @media (max-width: 768px) {
            .tree-inputs, .field-inputs {
                flex-direction: column;
                align-items: stretch;
                width: 100%;
            }

            .tree-key-input, .field-key-input,
            .tree-value-input, .field-value-input,
            .tree-type-select, .field-type-select {
                width: 100%;
                max-width: none;
                min-width: unset;
            }

            .tree-key-input, .field-key-input {
                order: 1;
            }

            .tree-type-select, .field-type-select {
                order: 2;
                width: auto;
                align-self: flex-start;
            }

            .tree-value-input, .field-value-input {
                order: 3;
            }
        }

        @media (max-width: 480px) {
            .tree-actions, .field-actions {
                position: absolute;
                top: var(--md-sys-spacing-2);
                right: var(--md-sys-spacing-2);
                background: rgba(var(--md-sys-color-surface), 0.9);
                border-radius: var(--md-sys-shape-corner-small);
                padding: 2px;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                opacity: 0;
                transition: opacity 0.2s;
            }

            .tree-node-content:active .tree-actions,
            .tree-node-content:hover .tree-actions,
            .article-field-content:active .field-actions,
            .article-field-content:hover .field-actions {
                opacity: 1;
            }
        }

        .json-preview {
            font-size: 0.75rem;
        }

        @media (max-width: 480px) {
            .json-preview {
                font-size: 0.7rem;
            }
        }

        .texture-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            opacity: 0.02;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
        }

        .badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 20px;
            height: 20px;
            padding: 0 6px;
            background-color: var(--md-sys-color-error);
            color: var(--md-sys-color-on-error);
            border-radius: var(--md-sys-shape-corner-full);
            font: var(--md-sys-typescale-label-small, 500 0.7rem/1 'Roboto Flex');
            margin-left: var(--md-sys-spacing-2);
        }

        .live-indicator {
            display: inline-flex;
            align-items: center;
            gap: var(--md-sys-spacing-2);
            font: var(--md-sys-typescale-label-medium);
            color: var(--md-sys-color-primary);
            margin-left: auto;
        }

        @media (max-width: 480px) {
            .live-indicator {
                display: none;
            }
        }

        .live-dot {
            width: 8px;
            height: 8px;
            background-color: var(--md-sys-color-primary);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Article Generator Styles */
        .article-generator {
            margin-top: var(--md-sys-spacing-6);
        }

        @media (max-width: 768px) {
            .article-generator {
                margin-top: var(--md-sys-spacing-4);
            }
        }

        .article-section {
            margin-bottom: var(--md-sys-spacing-6);
        }

        @media (max-width: 768px) {
            .article-section {
                margin-bottom: var(--md-sys-spacing-4);
            }
        }

        .article-section-title {
            font: var(--md-sys-typescale-title-medium);
            color: var(--md-sys-color-on-surface);
            margin-bottom: var(--md-sys-spacing-3);
            display: flex;
            align-items: center;
            gap: var(--md-sys-spacing-2);
        }

        @media (max-width: 480px) {
            .article-section-title {
                font: var(--md-sys-typescale-body-large);
                font-weight: 600;
            }
        }

        .form-group {
            margin-bottom: var(--md-sys-spacing-4);
        }

        @media (max-width: 768px) {
            .form-group {
                margin-bottom: var(--md-sys-spacing-3);
            }
        }

        .form-label {
            display: block;
            font: var(--md-sys-typescale-label-large);
            color: var(--md-sys-color-on-surface);
            margin-bottom: var(--md-sys-spacing-2);
        }

        @media (max-width: 480px) {
            .form-label {
                font: var(--md-sys-typescale-label-medium);
            }
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: var(--md-sys-spacing-3) var(--md-sys-spacing-4);
            border: 1px solid var(--md-sys-color-outline);
            border-radius: var(--md-sys-shape-corner-small);
            background-color: var(--md-sys-color-surface);
            color: var(--md-sys-color-on-surface);
            font: var(--md-sys-typescale-body-medium);
            outline: none;
            transition: all var(--md-sys-motion-duration-short);
        }

        @media (max-width: 768px) {
            .form-input,
            .form-select,
            .form-textarea {
                padding: var(--md-sys-spacing-2) var(--md-sys-spacing-3);
                font: var(--md-sys-typescale-body-medium);
            }
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            border-color: var(--md-sys-color-primary);
            box-shadow: 0 0 0 2px var(--md-sys-color-primary-container);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
            font-family: 'Roboto Flex', sans-serif;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .form-textarea {
                min-height: 100px;
            }
        }

        .form-select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 16px;
            padding-right: 40px;
        }

        .radio-group {
            display: flex;
            flex-wrap: wrap;
            gap: var(--md-sys-spacing-2);
        }

        @media (max-width: 480px) {
            .radio-group {
                gap: var(--md-sys-spacing-1);
            }
        }

        .radio-item {
            position: relative;
        }

        .radio-item input[type="radio"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
        }

        .radio-label {
            display: inline-flex;
            align-items: center;
            gap: var(--md-sys-spacing-2);
            padding: var(--md-sys-spacing-2) var(--md-sys-spacing-4);
            background-color: var(--md-sys-color-surface-variant);
            color: var(--md-sys-color-on-surface-variant);
            border-radius: var(--md-sys-shape-corner-small);
            font: var(--md-sys-typescale-label-large);
            cursor: pointer;
            transition: all var(--md-sys-motion-duration-short);
            border: 2px solid transparent;
            white-space: nowrap;
        }

        @media (max-width: 768px) {
            .radio-label {
                padding: var(--md-sys-spacing-2) var(--md-sys-spacing-3);
                font: var(--md-sys-typescale-label-medium);
            }
        }

        @media (max-width: 480px) {
            .radio-label {
                padding: var(--md-sys-spacing-1) var(--md-sys-spacing-2);
                font: var(--md-sys-typescale-label-small);
                gap: var(--md-sys-spacing-1);
            }
            
            .radio-label .material-symbols-rounded {
                font-size: 16px !important;
            }
        }

        .radio-item input[type="radio"]:checked + .radio-label {
            background-color: var(--md-sys-color-primary-container);
            color: var(--md-sys-color-on-primary-container);
            border-color: var(--md-sys-color-primary);
        }

        .radio-label:hover {
            background-color: var(--md-sys-color-secondary-container);
        }

        .output-area {
            background-color: var(--md-sys-color-surface);
            border: 1px solid var(--md-sys-color-outline-variant);
            border-radius: var(--md-sys-shape-corner-medium);
            padding: var(--md-sys-spacing-4);
            min-height: 200px;
            max-height: 400px;
            overflow-y: auto;
            font: var(--md-sys-typescale-body-medium);
            line-height: 1.8;
            color: var(--md-sys-color-on-surface);
            white-space: pre-wrap;
            position: relative;
            -webkit-overflow-scrolling: touch;
        }

        @media (max-width: 768px) {
            .output-area {
                padding: var(--md-sys-spacing-3);
                min-height: 150px;
                max-height: 300px;
                font: var(--md-sys-typescale-body-medium);
            }
        }

        .output-area:empty::before {
            content: 'Hasil prompt akan muncul di sini...';
            color: var(--md-sys-color-outline);
            font-style: italic;
        }

        .btn-generate {
            background: linear-gradient(135deg, var(--md-sys-color-primary), var(--md-sys-color-tertiary));
            color: var(--md-sys-color-on-primary);
            font-size: 1rem;
            padding: var(--md-sys-spacing-4) var(--md-sys-spacing-8);
            box-shadow: 0 4px 12px rgba(56, 106, 32, 0.3);
        }

        @media (max-width: 768px) {
            .btn-generate {
                padding: var(--md-sys-spacing-3) var(--md-sys-spacing-6);
                font-size: 0.9375rem;
            }
        }

        @media (max-width: 480px) {
            .btn-generate {
                width: 100%;
                padding: var(--md-sys-spacing-3);
            }
        }

        .btn-generate:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(56, 106, 32, 0.4);
        }

        .btn-generate:active {
            transform: translateY(0);
        }

        .btn-copy {
            position: absolute;
            top: var(--md-sys-spacing-3);
            right: var(--md-sys-spacing-3);
            background-color: var(--md-sys-color-surface-1);
            border: 1px solid var(--md-sys-color-outline-variant);
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--md-sys-spacing-4);
        }

        @media (max-width: 768px) {
            .two-column {
                grid-template-columns: 1fr;
                gap: var(--md-sys-spacing-3);
            }
        }

        .hint-text {
            font: var(--md-sys-typescale-label-medium);
            color: var(--md-sys-color-on-surface-variant);
            margin-top: var(--md-sys-spacing-1);
        }

        @media (max-width: 480px) {
            .hint-text {
                font: var(--md-sys-typescale-label-small);
            }
        }

        .divider {
            height: 1px;
            background-color: var(--md-sys-color-outline-variant);
            margin: var(--md-sys-spacing-6) 0;
        }

        @media (max-width: 768px) {
            .divider {
                margin: var(--md-sys-spacing-4) 0;
            }
        }

        .article-tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--md-sys-spacing-6);
        }

        @media (max-width: 768px) {
            .article-tools-grid {
                grid-template-columns: 1fr;
                gap: var(--md-sys-spacing-4);
            }
        }

        .tool-nav {
            display: flex;
            gap: var(--md-sys-spacing-2);
            margin-bottom: var(--md-sys-spacing-4);
            border-bottom: 1px solid var(--md-sys-color-outline-variant);
            padding-bottom: var(--md-sys-spacing-4);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        @media (max-width: 768px) {
            .tool-nav {
                margin-bottom: var(--md-sys-spacing-3);
                padding-bottom: var(--md-sys-spacing-3);
                gap: var(--md-sys-spacing-1);
            }
        }

        .tool-nav-btn {
            padding: var(--md-sys-spacing-3) var(--md-sys-spacing-5);
            background: transparent;
            border: none;
            color: var(--md-sys-color-on-surface-variant);
            font: var(--md-sys-typescale-label-large);
            cursor: pointer;
            border-radius: var(--md-sys-shape-corner-small);
            transition: all var(--md-sys-motion-duration-short);
            position: relative;
            white-space: nowrap;
            flex-shrink: 0;
        }

        @media (max-width: 768px) {
            .tool-nav-btn {
                padding: var(--md-sys-spacing-2) var(--md-sys-spacing-4);
                font: var(--md-sys-typescale-label-medium);
            }
        }

        @media (max-width: 480px) {
            .tool-nav-btn {
                padding: var(--md-sys-spacing-2) var(--md-sys-spacing-3);
                font: var(--md-sys-typescale-label-medium);
            }
            
            .tool-nav-btn .material-symbols-rounded {
                margin-right: 4px !important;
                font-size: 18px !important;
            }
        }

        .tool-nav-btn:hover {
            background-color: var(--md-sys-color-surface-variant);
            color: var(--md-sys-color-on-surface);
        }

        .tool-nav-btn.active {
            color: var(--md-sys-color-primary);
            background-color: var(--md-sys-color-primary-container);
        }

        .tool-nav-btn.active::after {
            content: '';
            position: absolute;
            bottom: -17px;
            left: 0;
            right: 0;
            height: 3px;
            background-color: var(--md-sys-color-primary);
            border-radius: 3px 3px 0 0;
        }

        @media (max-width: 768px) {
            .tool-nav-btn.active::after {
                bottom: -13px;
            }
        }

        .tool-content {
            display: none;
        }

        .tool-content.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .char-counter {
            text-align: right;
            font: var(--md-sys-typescale-label-medium);
            color: var(--md-sys-color-on-surface-variant);
            margin-top: var(--md-sys-spacing-1);
        }

        @media (max-width: 480px) {
            .char-counter {
                font: var(--md-sys-typescale-label-small);
            }
        }

        .char-counter.warning {
            color: var(--md-sys-color-error);
        }

        /* Example Box Styles */
        .example-box {
            background-color: var(--md-sys-color-secondary-container);
            border-left: 4px solid var(--md-sys-color-secondary);
            padding: var(--md-sys-spacing-4);
            margin-top: var(--md-sys-spacing-3);
            border-radius: 0 var(--md-sys-shape-corner-small) var(--md-sys-shape-corner-small) 0;
            font: var(--md-sys-typescale-body-medium);
            color: var(--md-sys-color-on-secondary-container);
        }

        @media (max-width: 768px) {
            .example-box {
                padding: var(--md-sys-spacing-3);
                font: var(--md-sys-typescale-body-medium);
            }
        }

        @media (max-width: 480px) {
            .example-box {
                padding: var(--md-sys-spacing-2);
                font: var(--md-sys-typescale-body-small);
            }
        }

        .example-box-title {
            font: var(--md-sys-typescale-label-large);
            font-weight: 600;
            margin-bottom: var(--md-sys-spacing-2);
            display: flex;
            align-items: center;
            gap: var(--md-sys-spacing-2);
        }

        @media (max-width: 480px) {
            .example-box-title {
                font: var(--md-sys-typescale-label-medium);
            }
        }

        .example-item {
            margin-bottom: var(--md-sys-spacing-2);
            padding-left: var(--md-sys-spacing-3);
            border-left: 2px solid var(--md-sys-color-outline-variant);
        }

        @media (max-width: 480px) {
            .example-item {
                margin-bottom: var(--md-sys-spacing-1);
                padding-left: var(--md-sys-spacing-2);
            }
        }

        .example-item:last-child {
            margin-bottom: 0;
        }

        .example-label {
            font-weight: 600;
            color: var(--md-sys-color-secondary);
        }

        .load-example-btn {
            margin-top: var(--md-sys-spacing-3);
            font-size: 0.875rem;
            padding: var(--md-sys-spacing-2) var(--md-sys-spacing-4);
        }

        @media (max-width: 480px) {
            .load-example-btn {
                width: 100%;
                margin-top: var(--md-sys-spacing-2);
            }
        }

        /* Field Editor Tabs */
        .field-editor-tabs {
            display: flex;
            gap: var(--md-sys-spacing-2);
            margin-bottom: var(--md-sys-spacing-4);
            border-bottom: 1px solid var(--md-sys-color-outline-variant);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        @media (max-width: 768px) {
            .field-editor-tabs {
                margin-bottom: var(--md-sys-spacing-3);
                gap: var(--md-sys-spacing-1);
            }
        }

        .field-editor-tab {
            padding: var(--md-sys-spacing-3) var(--md-sys-spacing-4);
            background: transparent;
            border: none;
            color: var(--md-sys-color-on-surface-variant);
            font: var(--md-sys-typescale-label-large);
            cursor: pointer;
            border-radius: var(--md-sys-shape-corner-small) var(--md-sys-shape-corner-small) 0 0;
            transition: all var(--md-sys-motion-duration-short);
            position: relative;
            white-space: nowrap;
            flex-shrink: 0;
        }

        @media (max-width: 768px) {
            .field-editor-tab {
                padding: var(--md-sys-spacing-2) var(--md-sys-spacing-3);
                font: var(--md-sys-typescale-label-medium);
            }
        }

        .field-editor-tab:hover {
            background-color: var(--md-sys-color-surface-variant);
            color: var(--md-sys-color-on-surface);
        }

        .field-editor-tab.active {
            color: var(--md-sys-color-primary);
            background-color: var(--md-sys-color-primary-container);
        }

        .field-editor-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 2px;
            background-color: var(--md-sys-color-primary);
        }

        .field-editor-content {
            display: none;
        }

        .field-editor-content.active {
            display: block;
        }

        .preset-fields {
            display: flex;
            flex-wrap: wrap;
            gap: var(--md-sys-spacing-2);
            margin-bottom: var(--md-sys-spacing-4);
        }

        @media (max-width: 768px) {
            .preset-fields {
                gap: var(--md-sys-spacing-1);
                margin-bottom: var(--md-sys-spacing-3);
            }
        }

        .preset-chip {
            display: inline-flex;
            align-items: center;
            gap: var(--md-sys-spacing-1);
            padding: var(--md-sys-spacing-2) var(--md-sys-spacing-3);
            background-color: var(--md-sys-color-tertiary-container);
            color: var(--md-sys-color-on-tertiary-container);
            border-radius: var(--md-sys-shape-corner-small);
            font: var(--md-sys-typescale-label-medium);
            cursor: pointer;
            transition: all var(--md-sys-motion-duration-short);
            border: 1px solid transparent;
            white-space: nowrap;
        }

        @media (max-width: 480px) {
            .preset-chip {
                padding: var(--md-sys-spacing-1) var(--md-sys-spacing-2);
                font: var(--md-sys-typescale-label-small);
            }
            
            .preset-chip .material-symbols-rounded {
                font-size: 16px !important;
            }
        }

        .preset-chip:hover {
            background-color: var(--md-sys-color-tertiary);
            color: var(--md-sys-color-on-tertiary);
        }

        /* Touch-friendly improvements */
        @media (hover: none) and (pointer: coarse) {
            .drag-handle, .field-drag-handle {
                opacity: 1;
                padding: var(--md-sys-spacing-2);
            }
            
            .icon-btn {
                width: 36px;
                height: 36px;
            }
            
            .tree-toggle, .field-toggle {
                width: 24px;
                height: 24px;
            }
        }

        /* Prevent text selection during drag */
        .dragging, .dragging * {
            user-select: none !important;
            -webkit-user-select: none !important;
        }

        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }

        /* Focus visible for accessibility */
        *:focus-visible {
            outline: 2px solid var(--md-sys-color-primary);
            outline-offset: 2px;
        }

        /* Reduce motion for accessibility */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <div class="nature-bg">
        <div class="leaf-ornament leaf-1"></div>
        <div class="leaf-ornament leaf-2"></div>
        <div class="leaf-ornament leaf-3"></div>
        <div class="circle-ornament circle-1"></div>
        <div class="circle-ornament circle-2"></div>
    </div>
    <div class="texture-overlay"></div>

    <div class="app-container">
        <header class="app-bar">
            <div class="app-bar-left">
                <div class="logo">
                    <span class="material-symbols-rounded">account_tree</span>
                </div>
                <h1 class="app-title">Nature JSON Builder</h1>
            </div>
            <div class="app-bar-actions">
                <button class="icon-btn" onclick="toggleTheme()" title="Toggle Theme" aria-label="Toggle theme">
                    <span class="material-symbols-rounded">dark_mode</span>
                </button>
                <button class="icon-btn" onclick="showHelp()" title="Help" aria-label="Show help">
                    <span class="material-symbols-rounded">help</span>
                </button>
            </div>
        </header>

        <div class="tool-nav">
            <button class="tool-nav-btn active" onclick="switchTool('json')">
                <span class="material-symbols-rounded" style="vertical-align: middle; margin-right: 8px;">account_tree</span>
                <span class="nav-text">JSON Builder</span>
            </button>
            <button class="tool-nav-btn" onclick="switchTool('article')">
                <span class="material-symbols-rounded" style="vertical-align: middle; margin-right: 8px;">article</span>
                <span class="nav-text">Article Generator</span>
            </button>
        </div>

        <!-- JSON Builder Tool -->
        <div id="json-tool" class="tool-content active">
            <div class="main-layout">
                <div class="builder-section">
                    <div class="card">
                        <div class="card-title">
                            <span class="material-symbols-rounded">tune</span>
                            Tree Structure Editor
                        </div>
                        <div class="card-subtitle">Edit struktur JSON hierarkis - Live Preview otomatis</div>
                        
                        <div class="chip-group">
                            <span class="chip active" onclick="loadTemplate('empty')">Empty</span>
                            <span class="chip" onclick="loadTemplate('image_to_text')">Image to Text (Lite)</span>
                            <span class="chip" onclick="loadTemplate('image_prompt')">Image Prompt (Pro)</span>
                        </div>

                        <div class="tree-container" id="treeContainer">
                        </div>

                        <div class="action-bar" style="margin-top: var(--md-sys-spacing-4);">
                            <button class="btn btn-filled" onclick="addRootNode()">
                                <span class="material-symbols-rounded">add</span>
                                <span class="btn-tex">Tambah Root</span>
                            </button>
                            <button class="btn btn-outlined" onclick="expandAll()">
                                <span class="material-symbols-rounded">unfold_more</span>
                                <span class="btn-text">Expand</span>
                            </button>
                            <button class="btn btn-outlined" onclick="collapseAll()">
                                <span class="material-symbols-rounded">unfold_less</span>
                                <span class="btn-text">Collapse</span>
                            </button>
                            <button class="btn btn-text" onclick="clearAll()">
                                <span class="material-symbols-rounded">delete_sweep</span>
                                <span class="btn-text">Clear</span>
                            </button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-title">
                            <span class="material-symbols-rounded">tips_and_updates</span>
                            Perbedaan Template
                        </div>
                        <ul style="color: var(--md-sys-color-on-surface-variant); padding-left: 20px; line-height: 1.8;">
                            <li><strong>Image to Text (Lite):</strong> Struktur sederhana dengan override dan output basic</li>
                            <li><strong>Image Prompt (Pro):</strong> Struktur lengkap 8 kategori untuk AI image generation</li>
                            <li><strong>Main Subject:</strong> Deskripsi karakter (Gender, Age, Ethnicity, Body Type, Skin Color)</li>
                            <li><strong>Facial Features:</strong> Detail wajah dan rambut</li>
                            <li><strong>Clothing:</strong> Pakaian lengkap dengan aksesoris</li>
                            <li><strong>Pose:</strong> Gaya pose dan arah pandangan</li>
                            <li><strong>Environment:</strong> Setting dan background</li>
                            <li><strong>Visual Technique:</strong> Gaya seni dan pencahayaan</li>
                            <li><strong>Quality:</strong> Resolusi dan parameter teknis</li>
                            <li><strong>Negative Prompt:</strong> Elemen yang dihindari</li>
                        </ul>
                    </div>
                </div>

                <div class="output-section">
                    <div class="card output-card">
                        <div class="card-title">
                            <span class="material-symbols-rounded">code</span>
                            Live Preview JSON
                            <span class="badge" id="nodeCount">0</span>
                            <div class="live-indicator">
                                <div class="live-dot"></div>
                                LIVE
                            </div>
                        </div>
                        
                        <div class="json-preview" id="jsonPreview">
                            <button class="icon-btn copy-btn" onclick="copyOutput()" title="Copy to Clipboard" aria-label="Copy to clipboard">
                                <span class="material-symbols-rounded">content_copy</span>
                            </button>
                            <code id="jsonCode"></code>
                        </div>

                        <div class="action-bar">
                            <button class="btn btn-filled" onclick="copyOutput()">
                                <span class="material-symbols-rounded">content_copy</span>
                                Salin JSON
                            </button>
                            <button class="btn btn-tonal" onclick="downloadJSON()">
                                <span class="material-symbols-rounded">download</span>
                                Unduh
                            </button>
                        </div>
                    </div>

                    <div class="card" style="margin-top: var(--md-sys-spacing-4);">
                        <div class="card-title">
                            <span class="material-symbols-rounded">fact_check</span>
                            Status
                        </div>
                        <div id="validationStatus" style="color: var(--md-sys-color-on-surface-variant); font: var(--md-sys-typescale-body-medium);">
                            <span class="material-symbols-rounded" style="vertical-align: middle; margin-right: 8px; color: var(--md-sys-color-primary);">check_circle</span>
                            Struktur valid
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Article Generator Tool -->
        <div id="article-tool" class="tool-content">
            <div class="main-layout">
                <div class="builder-section">
                    <div class="card">
                        <div class="card-title">
                            <span class="material-symbols-rounded">edit_note</span>
                            Article Generator - Field Editor
                        </div>
                        <div class="card-subtitle">Buat struktur field dinamis untuk konfigurasi artikel</div>
                        
                        <!-- Field Editor Tabs -->
                        <div class="field-editor-tabs">
                            <button class="field-editor-tab active" onclick="switchFieldTab('fields')">
                                <span class="material-symbols-rounded" style="vertical-align: middle; margin-right: 6px; font-size: 18px;">account_tree</span>
                                Edit Fields
                            </button>
                            <button class="field-editor-tab" onclick="switchFieldTab('presets')">
                                <span class="material-symbols-rounded" style="vertical-align: middle; margin-right: 6px; font-size: 18px;">bookmark</span>
                                Presets
                            </button>
                        </div>

                        <!-- Fields Tab -->
                        <div id="fields-tab" class="field-editor-content active">
                            <div class="preset-fields">
                                <span class="preset-chip" onclick="addPresetField('topic')">
                                    <span class="material-symbols-rounded" style="font-size: 16px;">add</span>
                                    Topik
                                </span>
                                <span class="preset-chip" onclick="addPresetField('role')">
                                    <span class="material-symbols-rounded" style="font-size: 16px;">add</span>
                                    Peran AI
                                </span>
                                <span class="preset-chip" onclick="addPresetField('style')">
                                    <span class="material-symbols-rounded" style="font-size: 16px;">add</span>
                                    Gaya
                                </span>
                                <span class="preset-chip" onclick="addPresetField('audience')">
                                    <span class="material-symbols-rounded" style="font-size: 16px;">add</span>
                                    Audiens
                                </span>
                                <span class="preset-chip" onclick="addPresetField('task')">
                                    <span class="material-symbols-rounded" style="font-size: 16px;">add</span>
                                    Tugas
                                </span>
                                <span class="preset-chip" onclick="addPresetField('word_count')">
                                    <span class="material-symbols-rounded" style="font-size: 16px;">add</span>
                                    Kata
                                </span>
                                <span class="preset-chip" onclick="addPresetField('format')">
                                    <span class="material-symbols-rounded" style="font-size: 16px;">add</span>
                                    Format
                                </span>
                                <span class="preset-chip" onclick="addPresetField('custom')">
                                    <span class="material-symbols-rounded" style="font-size: 16px;">add</span>
                                    Custom
                                </span>
                            </div>

                            <div class="article-field-container" id="articleFieldContainer">
                                <!-- Fields will be rendered here -->
                            </div>

                            <div class="action-bar">
                                <button class="btn btn-filled" onclick="addArticleRootField()">
                                    <span class="material-symbols-rounded">add</span>
                                    <span class="btn-text">Tambah Field</span>
                                </button>
                                <button class="btn btn-outlined" onclick="expandAllArticleFields()">
                                    <span class="material-symbols-rounded">unfold_more</span>
                                    <span class="btn-text">Expand</span>
                                </button>
                                <button class="btn btn-outlined" onclick="collapseAllArticleFields()">
                                    <span class="material-symbols-rounded">unfold_less</span>
                                    <span class="btn-text">Collapse</span>
                                </button>
                                <button class="btn btn-text" onclick="clearAllArticleFields()">
                                    <span class="material-symbols-rounded">delete_sweep</span>
                                    <span class="btn-text">Clear</span>
                                </button>
                            </div>
                        </div>

                        <!-- Presets Tab -->
                        <div id="presets-tab" class="field-editor-content">
                            <div class="chip-group">
                                <span class="chip active" onclick="loadArticlePreset('empty')">Empty</span>
                                <span class="chip" onclick="loadArticlePreset('general')">Umum</span>
                                <span class="chip" onclick="loadArticlePreset('blog')">Blog Post</span>
                                <span class="chip" onclick="loadArticlePreset('coding')">Coding</span>
                                <span class="chip" onclick="loadArticlePreset('storytelling')">Storytelling</span>
                                <span class="chip" onclick="loadArticlePreset('email')">Email Marketing</span>
                            </div>

                            <div class="example-box" style="margin-top: var(--md-sys-spacing-4);">
                                <div class="example-box-title">
                                    <span class="material-symbols-rounded">info</span>
                                    Tentang Preset
                                </div>
                                <p style="margin-bottom: var(--md-sys-spacing-2);">Preset akan mengisi field editor dengan struktur yang sudah dioptimalkan untuk setiap jenis konten.</p>
                                <ul style="padding-left: 20px; line-height: 1.8;">
                                    <li><strong>Umum:</strong> Struktur dasar untuk artikel berita umum</li>
                                    <li><strong>Blog Post:</strong> Optimasi untuk konten blog dengan SEO</li>
                                    <li><strong>Coding:</strong> Struktur untuk tutorial teknis</li>
                                    <li><strong>Storytelling:</strong> Setup untuk cerita fiksi</li>
                                    <li><strong>Email Marketing:</strong> Konfigurasi untuk email konversi</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-title">
                            <span class="material-symbols-rounded">tips_and_updates</span>
                            Panduan Field Editor
                        </div>
                        <ul style="color: var(--md-sys-color-on-surface-variant); padding-left: 20px; line-height: 1.8;">
                            <li><strong>Tambah Field:</strong> Gunakan tombol preset cepat atau "Tambah Field"</li>
                            <li><strong>Drag & Drop:</strong> Seret handle (garis-garis) untuk mengurutkan ulang field</li>
                            <li><strong>Tipe Data:</strong> Pilih String, Number, Boolean, Object, atau Array</li>
                            <li><strong>Object/Array:</strong> Field bertipe Object/Array bisa memiliki child fields</li>
                            <li><strong>Custom Field:</strong> Buat field dengan nama dan struktur bebas</li>
                            <li><strong>Live Preview:</strong> JSON di panel kanan update otomatis</li>
                        </ul>
                    </div>
                </div>

                <div class="output-section">
                    <div class="card output-card">
                        <div class="card-title">
                            <span class="material-symbols-rounded">code</span>
                            JSON Output
                            <span class="badge" id="articleFieldCount">0</span>
                            <div class="live-indicator">
                                <div class="live-dot"></div>
                                LIVE
                            </div>
                        </div>
                        
                        <div class="json-preview" id="article-json-preview">
                            <button class="icon-btn copy-btn" onclick="copyArticleOutput()" title="Copy to Clipboard" aria-label="Copy to clipboard">
                                <span class="material-symbols-rounded">content_copy</span>
                            </button>
                            <code id="article-json-code">{}</code>
                        </div>

                        <div class="action-bar">
                            <button class="btn btn-filled" onclick="copyArticleOutput()">
                                <span class="material-symbols-rounded">content_copy</span>
                                Salin JSON
                            </button>
                            <button class="btn btn-tonal" onclick="downloadArticleJSON()">
                                <span class="material-symbols-rounded">download</span>
                                Unduh JSON
                            </button>
                            <button class="btn btn-outlined" onclick="generateFromFields()">
                                <span class="material-symbols-rounded">auto_fix_high</span>
                                Generate
                            </button>
                        </div>
                    </div>

                    <div class="card" style="margin-top: var(--md-sys-spacing-4);">
                        <div class="card-title">
                            <span class="material-symbols-rounded">auto_stories</span>
                            Generated Prompt
                        </div>
                        <div class="output-area" id="generated-prompt-area" style="min-height: 150px; font-size: 0.875rem;">
                            Prompt akan muncul di sini setelah klik "Generate"
                        </div>
                        <div class="action-bar" style="margin-top: var(--md-sys-spacing-3);">
                            <button class="btn btn-tonal" onclick="copyGeneratedPrompt()">
                                <span class="material-symbols-rounded">content_copy</span>
                                Salin Prompt
                            </button>
                        </div>
                    </div>

                    <div class="card" style="margin-top: var(--md-sys-spacing-4);">
                        <div class="card-title">
                            <span class="material-symbols-rounded">fact_check</span>
                            Status
                        </div>
                        <div id="article-validation-status" style="color: var(--md-sys-color-on-surface-variant); font: var(--md-sys-typescale-body-medium);">
                            <span class="material-symbols-rounded" style="vertical-align: middle; margin-right: 8px; color: var(--md-sys-color-primary);">check_circle</span>
                            Struktur valid - Siap generate prompt
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="snackbar" id="snackbar">
        <span class="material-symbols-rounded">check_circle</span>
        <span id="snackbarText">Tindakan berhasil!</span>
    </div>

    <div class="dialog-overlay" id="dialog" onclick="closeDialog(event)">
        <div class="dialog" onclick="event.stopPropagation()">
            <h2 class="dialog-title" id="dialogTitle">Title</h2>
            <div class="dialog-content" id="dialogContent">Content</div>
            <div class="dialog-actions">
                <button class="btn btn-text" onclick="closeDialog()">Tutup</button>
                <button class="btn btn-filled" id="dialogConfirm" onclick="confirmDialog()">OK</button>
            </div>
        </div>
    </div>

    <script>
        // Global variables for JSON Builder
        let treeData = [];
        let draggedNode = null;
        let draggedPath = null;

        // Global variables for Article Generator Field Editor
        let articleFields = [];
        let draggedArticleField = null;
        let draggedArticlePath = null;

        // Article Presets
        const articlePresets = {
            empty: [],
            
            general: [
                { id: 'af_1', key: 'topic', value: 'general', type: 'string', expanded: true, children: [] },
                { id: 'af_2', key: 'ai_role', value: 'Jurnalis senior dengan pengalaman 10 tahun', type: 'string', expanded: true, children: [] },
                { id: 'af_3', key: 'language_style', value: 'formal', type: 'string', expanded: true, children: [] },
                { id: 'af_4', key: 'target_audience', value: 'Masyarakat umum, pembaca 25-50 tahun', type: 'string', expanded: true, children: [] },
                { id: 'af_5', key: 'word_limit', value: 800, type: 'number', expanded: true, children: [] },
                { id: 'af_6', key: 'main_task', value: 'Tulis artikel berita tentang peluncuran teknologi renewable energy terbaru di Indonesia', type: 'string', expanded: true, children: [] },
                { id: 'af_7', key: 'technical_specs', value: 'Gunakan fakta terkini, sertakan data statistik, hindari opini pribadi', type: 'string', expanded: true, children: [] }
            ],
            
            blog: [
                { id: 'af_1', key: 'topic', value: 'blog', type: 'string', expanded: true, children: [] },
                { id: 'af_2', key: 'ai_role', value: 'Content writer profesional spesialis lifestyle', type: 'string', expanded: true, children: [] },
                { id: 'af_3', key: 'language_style', value: 'casual', type: 'string', expanded: true, children: [] },
                { id: 'af_4', key: 'target_audience', value: 'Millennial dan Gen Z, pengguna aktif media sosial', type: 'string', expanded: true, children: [] },
                { id: 'af_5', key: 'word_limit', value: 1200, type: 'number', expanded: true, children: [] },
                { id: 'af_6', key: 'main_task', value: 'Buat blog post tentang 5 Morning Routine yang Bikin Hari Lebih Produktif', type: 'string', expanded: true, children: [] },
                { id: 'af_7', key: 'seo_keywords', value: 'morning routine, produktivitas, habits', type: 'string', expanded: true, children: [] },
                { id: 'af_8', key: 'technical_specs', value: 'Gunakan tone friendly, tambahkan emoji strategis, sertakan CTA di akhir', type: 'string', expanded: true, children: [] }
            ],
            
            coding: [
                { id: 'af_1', key: 'topic', value: 'coding', type: 'string', expanded: true, children: [] },
                { id: 'af_2', key: 'ai_role', value: 'Senior Software Engineer dan technical writer', type: 'string', expanded: true, children: [] },
                { id: 'af_3', key: 'language_style', value: 'professional', type: 'string', expanded: true, children: [] },
                { id: 'af_4', key: 'target_audience', value: 'Developer pemula hingga menengah', type: 'string', expanded: true, children: [] },
                { id: 'af_5', key: 'word_limit', value: 1500, type: 'number', expanded: true, children: [] },
                { id: 'af_6', key: 'main_task', value: 'Buat tutorial lengkap Membangun REST API dengan Node.js dan Express', type: 'string', expanded: true, children: [] },
                { id: 'af_7', key: 'code_requirements', value: 'Sertakan code snippet, penjelasan step-by-step, best practices', type: 'string', expanded: true, children: [] },
                { id: 'af_8', key: 'technical_specs', value: 'Gunakan bahasa Indonesia dengan terminologi teknis dalam bahasa Inggris', type: 'string', expanded: true, children: [] }
            ],
            
            storytelling: [
                { id: 'af_1', key: 'topic', value: 'storytelling', type: 'string', expanded: true, children: [] },
                { id: 'af_2', key: 'ai_role', value: 'Penulis fiksi kreatif yang telah menerbitkan 3 novel thriller', type: 'string', expanded: true, children: [] },
                { id: 'af_3', key: 'language_style', value: 'creative', type: 'string', expanded: true, children: [] },
                { id: 'af_4', key: 'target_audience', value: 'Pecinta genre thriller psikologis', type: 'string', expanded: true, children: [] },
                { id: 'af_5', key: 'word_limit', value: 2000, type: 'number', expanded: true, children: [] },
                { id: 'af_6', key: 'main_task', value: 'Tulis cerita pendek thriller dengan setting di stasiun kereta api tua yang angker', type: 'string', expanded: true, children: [] },
                { id: 'af_7', key: 'character', value: 'Alex Mercer, mantan detektif yang kehilangan ingatan', type: 'string', expanded: true, children: [] },
                { id: 'af_8', key: 'plot_twist', value: 'Ending dengan twist yang tak terduga', type: 'string', expanded: true, children: [] },
                { id: 'af_9', key: 'technical_specs', value: 'Gunakan teknik show dont tell, deskripsikan setting dengan detail sensorial', type: 'string', expanded: true, children: [] }
            ],
            
            email: [
                { id: 'af_1', key: 'topic', value: 'email', type: 'string', expanded: true, children: [] },
                { id: 'af_2', key: 'ai_role', value: 'Email marketing specialist dengan conversion rate tinggi', type: 'string', expanded: true, children: [] },
                { id: 'af_3', key: 'language_style', value: 'persuasive', type: 'string', expanded: true, children: [] },
                { id: 'af_4', key: 'target_audience', value: 'Customer existing dan potential leads, usia 25-45 tahun', type: 'string', expanded: true, children: [] },
                { id: 'af_5', key: 'word_limit', value: 300, type: 'number', expanded: true, children: [] },
                { id: 'af_6', key: 'main_task', value: 'Buat email marketing untuk launching produk skincare baru Glow Serum', type: 'string', expanded: true, children: [] },
                { id: 'af_7', key: 'cta_goal', value: 'Drive traffic ke landing page dan tingkatkan pre-order', type: 'string', expanded: true, children: [] },
                { id: 'af_8', key: 'urgency', value: 'Limited time offer - 48 jam', type: 'string', expanded: true, children: [] },
                { id: 'af_9', key: 'technical_specs', value: 'Subject line catchy max 50 karakter, personalisasi dengan nama recipient', type: 'string', expanded: true, children: [] }
            ]
        };

        // Preset field definitions
        const presetFieldDefinitions = {
            topic: { key: 'topic', value: 'general', type: 'string' },
            role: { key: 'ai_role', value: '', type: 'string' },
            style: { key: 'language_style', value: 'formal', type: 'string' },
            audience: { key: 'target_audience', value: '', type: 'string' },
            task: { key: 'main_task', value: '', type: 'string' },
            word_count: { key: 'word_limit', value: 1000, type: 'number' },
            format: { key: 'output_format', value: 'narrative', type: 'string' },
            custom: { key: 'custom_field', value: '', type: 'string' }
        };

        // TEMPLATE definitions
        const templates = {
            empty: [],
            
            image_to_text: [
                {
                    id: 'root_1',
                    key: 'action',
                    value: 'image_to_text',
                    type: 'string',
                    expanded: true,
                    children: []
                },
                {
                    id: 'root_2',
                    key: 'taks',
                    value: 'membuat prompt lengkap berdasarkan referensi gambar dengan lengkap',
                    type: 'string',
                    expanded: true,
                    children: []
                },
                {
                    id: 'root_3',
                    key: 'action_input',
                    value: '',
                    type: 'object',
                    expanded: true,
                    children: [
                        {
                            id: 'child_1_1',
                            key: 'override',
                            value: '',
                            type: 'object',
                            expanded: true,
                            children: [
                                { id: 'child_1_1_1', key: 'Rasio', value: '9:16', type: 'string', expanded: true, children: [] },
                                { id: 'child_1_1_2', key: 'Art Style', value: 'Photo Realistic', type: 'string', expanded: true, children: [] },
                                { id: 'child_1_1_3', key: 'Photo Shot', value: 'Full Body', type: 'string', expanded: true, children: [] }
                            ]
                        },
                        {
                            id: 'child_1_2',
                            key: 'Output',
                            value: '',
                            type: 'object',
                            expanded: true,
                            children: [
                                { id: 'child_1_2_1', key: 'Teks', value: 'maks 80 kata', type: 'string', expanded: true, children: [] },
                                { id: 'child_1_2_2', key: 'bahasa', value: 'inggris', type: 'string', expanded: true, children: [] },
                                { id: 'child_1_2_3', key: 'NB', value: 'hindari prompt ambigu', type: 'string', expanded: true, children: [] }
                            ]
                        }
                    ]
                }
            ],

            image_prompt: [
                {
                    id: 'root_1',
                    key: 'action',
                    value: 'image_to_text',
                    type: 'string',
                    expanded: true,
                    children: []
                },
                {
                    id: 'root_2',
                    key: 'taks',
                    value: 'membuat prompt lengkap berdasarkan referensi gambar dengan lengkap',
                    type: 'string',
                    expanded: true,
                    children: []
                },
                {
                    id: 'root_3',
                    key: 'action_input',
                    value: '',
                    type: 'object',
                    expanded: true,
                    children: [
                        {
                            id: 'child_1',
                            key: 'Main Subject',
                            value: '',
                            type: 'object',
                            expanded: true,
                            children: [
                                { id: 'child_1_1', key: 'Description', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_1_2', key: 'Gender', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_1_3', key: 'Age', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_1_4', key: 'Ethnicity', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_1_5', key: 'Body Type', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_1_6', key: 'Skin Color', value: '', type: 'string', expanded: true, children: [] }
                            ]
                        },
                        {
                            id: 'child_2',
                            key: 'Facial Features',
                            value: '',
                            type: 'object',
                            expanded: true,
                            children: [
                                { id: 'child_2_1', key: 'Face Shape', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_2_2', key: 'Eye Color', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_2_3', key: 'Hair Color', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_2_4', key: 'Hair Length', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_2_5', key: 'Hairstyle', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_2_6', key: 'Facial Expression', value: '', type: 'string', expanded: true, children: [] }
                            ]
                        },
                        {
                            id: 'child_3',
                            key: 'Clothing',
                            value: '',
                            type: 'object',
                            expanded: true,
                            children: [
                                { id: 'child_3_1', key: 'Main Clothing Type', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_3_2', key: 'Top and bottom clothes', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_3_3', key: 'Clothing Details', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_3_4', key: 'Accessories', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_3_5', key: 'Footwear', value: '', type: 'string', expanded: true, children: [] }
                            ]
                        },
                        {
                            id: 'child_4',
                            key: 'Pose',
                            value: '',
                            type: 'object',
                            expanded: true,
                            children: [
                                { id: 'child_4_1', key: 'Pose Style', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_4_2', key: 'Movement Details', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_4_3', key: 'Eye Gaze Direction', value: '', type: 'string', expanded: true, children: [] }
                            ]
                        },
                        {
                            id: 'child_5',
                            key: 'Environment',
                            value: '',
                            type: 'object',
                            expanded: true,
                            children: [
                                { id: 'child_5_1', key: 'Location Setting', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_5_2', key: 'Background Description', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_5_3', key: 'Supporting Objects', value: '', type: 'string', expanded: true, children: [] }
                            ]
                        },
                        {
                            id: 'child_6',
                            key: 'Visual Technique',
                            value: '',
                            type: 'object',
                            expanded: true,
                            children: [
                                { id: 'child_6_1', key: 'Art/Photo Style', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_6_2', key: 'Lighting', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_6_3', key: 'Visual Technique', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_6_4', key: 'Mood', value: '', type: 'string', expanded: true, children: [] }
                            ]
                        },
                        {
                            id: 'child_7',
                            key: 'Quality',
                            value: '',
                            type: 'object',
                            expanded: true,
                            children: [
                                { id: 'child_7_1', key: 'Resolution', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_7_2', key: 'Seed', value: '', type: 'string', expanded: true, children: [] },
                                { id: 'child_7_3', key: 'Aspect Ratio', value: '', type: 'string', expanded: true, children: [] }
                            ]
                        },
                        {
                            id: 'child_8',
                            key: 'Negative Prompt',
                            value: '',
                            type: 'string',
                            expanded: true,
                            children: []
                        }
                    ]
                }
            ]
        };

        document.addEventListener('DOMContentLoaded', () => {
            renderTree();
            updateOutput();
            renderArticleFields();
            updateArticleOutput();
        });

        function generateId() {
            return 'node_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        function generateArticleFieldId() {
            return 'af_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        // JSON Builder Functions
        function getNodeByPath(pathArray) {
            let current = treeData;
            let parent = null;
            
            for (let i = 0; i < pathArray.length; i++) {
                parent = current;
                current = current[pathArray[i]];
                if (!current) return null;
                if (i < pathArray.length - 1 && current.children) {
                    current = current.children;
                }
            }
            
            return { node: current, parent: parent, isRoot: pathArray.length === 1 };
        }

        function renderTree() {
            const container = document.getElementById('treeContainer');
            
            if (treeData.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon material-symbols-rounded">account_tree</div>
                        <p>Belum ada data. Klik "Tambah Root" untuk memulai.</p>
                    </div>
                `;
                updateNodeCount();
                return;
            }

            container.innerHTML = renderNodes(treeData, 0, []);
            attachDragHandlers();
            updateNodeCount();
        }

        function renderNodes(nodes, depth, parentPath) {
            if (!nodes || nodes.length === 0) return '';

            return nodes.map((node, index) => {
                const hasChildren = node.children && node.children.length > 0;
                const isExpandable = node.type === 'object' || node.type === 'array';
                const currentPath = [...parentPath, index];
                const pathString = currentPath.join('-');
                
                let indentHtml = '';
                for (let i = 0; i < depth; i++) {
                    const isLast = i === depth - 1;
                    indentHtml += `<div class="tree-line ${isLast ? 'last' : ''}"></div>`;
                }

                const icon = node.type === 'object' ? 'data_object' : 
                           node.type === 'array' ? 'data_array' : 'text_fields';
                
                const iconClass = node.type === 'object' ? 'tree-icon object' : 
                                node.type === 'array' ? 'tree-icon array' : 'tree-icon';

                const showToggle = isExpandable;
                const toggleClass = node.expanded ? 'expanded' : '';
                const childrenClass = node.expanded ? '' : 'collapsed';

                return `
                    <div class="tree-node" data-path="${pathString}" data-id="${node.id}">
                        <div class="tree-node-content" draggable="true" data-path="${pathString}">
                            <div class="tree-indent">
                                ${indentHtml}
                                ${showToggle ? `
                                    <div class="tree-toggle ${toggleClass} ${hasChildren ? '' : 'leaf'}" onclick="toggleNode('${pathString}')">
                                        <span class="material-symbols-rounded" style="font-size: 16px;">chevron_right</span>
                                    </div>
                                ` : '<div class="tree-toggle leaf"></div>'}
                            </div>
                            
                            <div class="drag-handle" title="Drag untuk mengurutkan">
                                <span class="material-symbols-rounded" style="font-size: 18px;">drag_indicator</span>
                            </div>

                            <span class="material-symbols-rounded ${iconClass}">${icon}</span>

                            <div class="tree-inputs">
                                <input type="text" class="tree-key-input" placeholder="Key" value="${escapeHtml(node.key)}" 
                                    oninput="updateNode('${pathString}', 'key', this.value)"
                                    onkeydown="handleInputKey(event, '${pathString}', 'key')">
                                
                                <input type="text" class="tree-value-input ${isExpandable ? 'object-mode' : ''}" 
                                    placeholder="Value" value="${escapeHtml(node.value)}" 
                                    oninput="updateNode('${pathString}', 'value', this.value)"
                                    onkeydown="handleInputKey(event, '${pathString}', 'value')"
                                    ${isExpandable ? 'disabled title="Object/Array memiliki children"' : ''}>
                                
                                <select class="tree-type-select" onchange="updateNode('${pathString}', 'type', this.value)">
                                    <option value="string" ${node.type === 'string' ? 'selected' : ''}>String</option>
                                    <option value="number" ${node.type === 'number' ? 'selected' : ''}>Number</option>
                                    <option value="boolean" ${node.type === 'boolean' ? 'selected' : ''}>Boolean</option>
                                    <option value="object" ${node.type === 'object' ? 'selected' : ''}>Object</option>
                                    <option value="array" ${node.type === 'array' ? 'selected' : ''}>Array</option>
                                    <option value="null" ${node.type === 'null' ? 'selected' : ''}>Null</option>
                                </select>
                            </div>

                            <div class="tree-actions">
                                ${isExpandable ? `
                                    <button class="icon-btn add-child" onclick="addChildNode('${pathString}')" title="Tambah child">
                                        <span class="material-symbols-rounded">add</span>
                                    </button>
                                ` : ''}
                                <button class="icon-btn copy" onclick="duplicateNode('${pathString}')" title="Duplikat">
                                    <span class="material-symbols-rounded">content_copy</span>
                                </button>
                                <button class="icon-btn delete" onclick="deleteNode('${pathString}')" title="Hapus">
                                    <span class="material-symbols-rounded">delete</span>
                                </button>
                            </div>
                        </div>
                        
                        ${hasChildren ? `
                            <div class="tree-children ${childrenClass}">
                                ${renderNodes(node.children, depth + 1, currentPath)}
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        function escapeHtml(text) {
            if (text === null || text === undefined) return '';
            return String(text)
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#039;');
        }

        function handleInputKey(event, path, field) {
            if (event.key === 'Enter') {
                event.target.blur();
            }
        }

        function attachDragHandlers() {
            const items = document.querySelectorAll('.tree-node-content');
            items.forEach(item => {
                item.addEventListener('dragstart', handleDragStart);
                item.addEventListener('dragend', handleDragEnd);
                item.addEventListener('dragover', handleDragOver);
                item.addEventListener('drop', handleDrop);
                item.addEventListener('dragenter', handleDragEnter);
                item.addEventListener('dragleave', handleDragLeave);
            });
        }

        function handleDragStart(e) {
            draggedNode = this;
            draggedPath = this.dataset.path;
            this.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/plain', draggedPath);
        }

        function handleDragEnd(e) {
            this.classList.remove('dragging');
            document.querySelectorAll('.tree-node-content').forEach(item => {
                item.classList.remove('drag-over');
            });
            draggedNode = null;
            draggedPath = null;
        }

        function handleDragOver(e) {
            if (e.preventDefault) {
                e.preventDefault();
            }
            e.dataTransfer.dropEffect = 'move';
            return false;
        }

        function handleDragEnter(e) {
            if (this !== draggedNode) {
                this.classList.add('drag-over');
            }
        }

        function handleDragLeave(e) {
            this.classList.remove('drag-over');
        }

        function handleDrop(e) {
            if (e.stopPropagation) {
                e.stopPropagation();
            }
            
            if (draggedNode !== this) {
                const sourcePath = draggedPath.split('-').map(Number);
                const targetPath = this.dataset.path.split('-').map(Number);
                
                const sourceResult = getNodeByPath(sourcePath);
                if (!sourceResult) return;
                
                const sourceNode = sourceResult.node;
                
                if (sourceResult.isRoot) {
                    treeData.splice(sourcePath[0], 1);
                } else {
                    const parentPath = sourcePath.slice(0, -1);
                    const parentResult = getNodeByPath(parentPath);
                    if (parentResult && parentResult.node.children) {
                        parentResult.node.children.splice(sourcePath[sourcePath.length - 1], 1);
                    }
                }
                
                if (targetPath.length === 1) {
                    treeData.splice(targetPath[0], 0, sourceNode);
                } else {
                    const targetParentPath = targetPath.slice(0, -1);
                    const targetParentResult = getNodeByPath(targetParentPath);
                    if (targetParentResult && targetParentResult.node.children) {
                        targetParentResult.node.children.splice(targetPath[targetPath.length - 1], 0, sourceNode);
                    }
                }
                
                renderTree();
                updateOutput();
                showSnackbar('Node dipindahkan');
            }
            
            return false;
        }

        function toggleNode(pathString) {
            const path = pathString.split('-').map(Number);
            const result = getNodeByPath(path);
            if (result && result.node) {
                result.node.expanded = !result.node.expanded;
                renderTree();
            }
        }

        function updateNode(pathString, property, value) {
            const path = pathString.split('-').map(Number);
            const result = getNodeByPath(path);
            
            if (!result || !result.node) {
                console.error('Node not found at path:', path);
                return;
            }
            
            const node = result.node;
            
            if (property === 'type') {
                const oldType = node.type;
                node.type = value;
                
                if ((value === 'object' || value === 'array') && !node.children) {
                    node.children = [];
                    node.expanded = true;
                }
                
                if ((oldType === 'object' || oldType === 'array') && 
                    (value !== 'object' && value !== 'array')) {
                    node.children = [];
                    node.value = '';
                }
                
                renderTree();
            } else {
                node[property] = value;
            }
            
            updateOutput();
        }

        function addRootNode() {
            const newNode = {
                id: generateId(),
                key: '',
                value: '',
                type: 'string',
                expanded: true,
                children: []
            };
            treeData.push(newNode);
            renderTree();
            updateOutput();
            
            setTimeout(() => {
                const inputs = document.querySelectorAll('.tree-key-input');
                if (inputs.length > 0) {
                    inputs[inputs.length - 1].focus();
                }
            }, 100);
        }

        function addChildNode(pathString) {
            const path = pathString.split('-').map(Number);
            const result = getNodeByPath(path);
            
            if (!result || !result.node) return;
            
            const node = result.node;
            
            if (!node.children) {
                node.children = [];
            }
            
            const newChild = {
                id: generateId(),
                key: '',
                value: '',
                type: 'string',
                expanded: true,
                children: []
            };
            
            node.children.push(newChild);
            node.expanded = true;
            renderTree();
            updateOutput();
        }

        function duplicateNode(pathString) {
            const path = pathString.split('-').map(Number);
            const result = getNodeByPath(path);
            
            if (!result || !result.node) return;
            
            const node = result.node;
            const clonedNode = JSON.parse(JSON.stringify(node));
            
            function updateIds(n) {
                n.id = generateId();
                if (n.children) {
                    n.children.forEach(updateIds);
                }
            }
            updateIds(clonedNode);
            
            if (result.isRoot) {
                treeData.splice(path[0] + 1, 0, clonedNode);
            } else {
                const parentPath = path.slice(0, -1);
                const parentResult = getNodeByPath(parentPath);
                if (parentResult && parentResult.node.children) {
                    parentResult.node.children.splice(path[path.length - 1] + 1, 0, clonedNode);
                }
            }
            
            renderTree();
            updateOutput();
        }

        function deleteNode(pathString) {
            const path = pathString.split('-').map(Number);
            const result = getNodeByPath(path);
            
            if (!result || !result.node) return;
            
            showDialog(
                'Hapus Node?',
                'Anda yakin ingin menghapus node ini dan semua children-nya?',
                () => {
                    if (result.isRoot) {
                        treeData.splice(path[0], 1);
                    } else {
                        const parentPath = path.slice(0, -1);
                        const parentResult = getNodeByPath(parentPath);
                        if (parentResult && parentResult.node.children) {
                            parentResult.node.children.splice(path[path.length - 1], 1);
                        }
                    }
                    renderTree();
                    updateOutput();
                }
            );
        }

        function expandAll() {
            function expand(node) {
                node.expanded = true;
                if (node.children) {
                    node.children.forEach(expand);
                }
            }
            treeData.forEach(expand);
            renderTree();
        }

        function collapseAll() {
            function collapse(node) {
                node.expanded = false;
                if (node.children) {
                    node.children.forEach(collapse);
                }
            }
            treeData.forEach(collapse);
            renderTree();
        }

        function clearAll() {
            if (treeData.length === 0) return;
            
            showDialog(
                'Hapus Semua?',
                `Anda yakin ingin menghapus ${countAllNodes(treeData)} node?`,
                () => {
                    treeData = [];
                    renderTree();
                    updateOutput();
                }
            );
        }

        function countAllNodes(nodes) {
            let count = nodes.length;
            nodes.forEach(node => {
                if (node.children) {
                    count += countAllNodes(node.children);
                }
            });
            return count;
        }

        function loadTemplate(templateName) {
            if (treeData.length > 0) {
                showDialog(
                    'Load Template',
                    'Data yang ada akan digantikan. Lanjutkan?',
                    () => {
                        applyTemplate(templateName);
                    }
                );
            } else {
                applyTemplate(templateName);
            }
        }

        function applyTemplate(templateName) {
            treeData = JSON.parse(JSON.stringify(templates[templateName]));
            
            function updateIds(node) {
                node.id = generateId();
                if (node.children) {
                    node.children.forEach(updateIds);
                }
            }
            treeData.forEach(updateIds);
            
            document.querySelectorAll('#json-tool .chip').forEach(chip => {
                chip.classList.remove('active');
            });
            event.target.classList.add('active');
            
            renderTree();
            updateOutput();
            
            const templateNames = {
                'empty': 'Empty',
                'image_to_text': 'Image to Text (Lite)',
                'image_prompt': 'Image Prompt (Pro)'
            };
            showSnackbar(`Template "${templateNames[templateName]}" dimuat`);
        }

        function generateJSON() {
            function convertNode(node) {
                let value;
                
                switch(node.type) {
                    case 'number':
                        value = parseFloat(node.value) || 0;
                        break;
                    case 'boolean':
                        value = node.value.toLowerCase() === 'true' || node.value === true || node.value === '1';
                        break;
                    case 'null':
                        value = null;
                        break;
                    case 'object':
                        value = {};
                        if (node.children) {
                            node.children.forEach(child => {
                                value[child.key] = convertNode(child);
                            });
                        }
                        break;
                    case 'array':
                        value = [];
                        if (node.children) {
                            node.children.forEach(child => {
                                value.push(convertNode(child));
                            });
                        }
                        break;
                    default:
                        value = node.value;
                }
                
                return value;
            }

            const result = {};
            treeData.forEach(node => {
                result[node.key] = convertNode(node);
            });
            
            return result;
        }

        function updateOutput() {
            const json = generateJSON();
            const jsonString = JSON.stringify(json, null, 2);
            
            const highlighted = jsonString
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?)/g, (match) => {
                    let cls = 'json-string';
                    if (/:\s*$/.test(match)) {
                        cls = 'json-key';
                        return `<span class="${cls}">${match}</span>`;
                    }
                    return `<span class="${cls}">${match}</span>`;
                })
                .replace(/\b(true|false)\b/g, '<span class="json-boolean">$1</span>')
                .replace(/\b(null)\b/g, '<span class="json-boolean">$1</span>')
                .replace(/\b(\d+\.?\d*)\b/g, '<span class="json-number">$1</span>');
            
            document.getElementById('jsonCode').innerHTML = highlighted;
            validateJSON();
        }

        function validateJSON() {
            try {
                const json = generateJSON();
                JSON.stringify(json);
                document.getElementById('validationStatus').innerHTML = `
                    <span class="material-symbols-rounded" style="vertical-align: middle; margin-right: 8px; color: var(--md-sys-color-primary);">check_circle</span>
                    Struktur valid
                `;
                return true;
            } catch(e) {
                document.getElementById('validationStatus').innerHTML = `
                    <span class="material-symbols-rounded" style="vertical-align: middle; margin-right: 8px; color: var(--md-sys-color-error);">error</span>
                    Error: ${e.message}
                `;
                return false;
            }
        }

        function copyOutput() {
            const json = JSON.stringify(generateJSON(), null, 2);
            navigator.clipboard.writeText(json).then(() => {
                showSnackbar('JSON disalin!');
            }).catch(() => {
                const textarea = document.createElement('textarea');
                textarea.value = json;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showSnackbar('JSON disalin!');
            });
        }

        function downloadJSON() {
            const json = JSON.stringify(generateJSON(), null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'config.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showSnackbar('File diunduh');
        }

        function updateNodeCount() {
            document.getElementById('nodeCount').textContent = countAllNodes(treeData);
        }

        // Article Generator Field Editor Functions
        function getArticleFieldByPath(pathArray) {
            let current = articleFields;
            let parent = null;
            
            for (let i = 0; i < pathArray.length; i++) {
                parent = current;
                current = current[pathArray[i]];
                if (!current) return null;
                if (i < pathArray.length - 1 && current.children) {
                    current = current.children;
                }
            }
            
            return { node: current, parent: parent, isRoot: pathArray.length === 1 };
        }

        function renderArticleFields() {
            const container = document.getElementById('articleFieldContainer');
            
            if (articleFields.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon material-symbols-rounded">edit_note</div>
                        <p>Belum ada field. Klik "Tambah Field" atau pilih preset untuk memulai.</p>
                    </div>
                `;
                updateArticleFieldCount();
                return;
            }

            container.innerHTML = renderArticleFieldNodes(articleFields, 0, []);
            attachArticleFieldDragHandlers();
            updateArticleFieldCount();
        }

        function renderArticleFieldNodes(nodes, depth, parentPath) {
            if (!nodes || nodes.length === 0) return '';

            return nodes.map((node, index) => {
                const hasChildren = node.children && node.children.length > 0;
                const isExpandable = node.type === 'object' || node.type === 'array';
                const currentPath = [...parentPath, index];
                const pathString = currentPath.join('-');
                
                let indentHtml = '';
                for (let i = 0; i < depth; i++) {
                    const isLast = i === depth - 1;
                    indentHtml += `<div class="field-line ${isLast ? 'last' : ''}"></div>`;
                }

                const icon = node.type === 'object' ? 'data_object' : 
                           node.type === 'array' ? 'data_array' : 'text_fields';
                
                const iconClass = node.type === 'object' ? 'field-icon object' : 
                                node.type === 'array' ? 'field-icon array' : 'field-icon';

                const showToggle = isExpandable;
                const toggleClass = node.expanded ? 'expanded' : '';
                const childrenClass = node.expanded ? '' : 'collapsed';

                return `
                    <div class="article-field-node" data-path="${pathString}" data-id="${node.id}">
                        <div class="article-field-content" draggable="true" data-path="${pathString}">
                            <div class="field-indent">
                                ${indentHtml}
                                ${showToggle ? `
                                    <div class="field-toggle ${toggleClass} ${hasChildren ? '' : 'leaf'}" onclick="toggleArticleField('${pathString}')">
                                        <span class="material-symbols-rounded" style="font-size: 16px;">chevron_right</span>
                                    </div>
                                ` : '<div class="field-toggle leaf"></div>'}
                            </div>
                            
                            <div class="field-drag-handle" title="Drag untuk mengurutkan">
                                <span class="material-symbols-rounded" style="font-size: 18px;">drag_indicator</span>
                            </div>

                            <span class="material-symbols-rounded ${iconClass}">${icon}</span>

                            <div class="field-inputs">
                                <input type="text" class="field-key-input" placeholder="Key" value="${escapeHtml(node.key)}" 
                                    oninput="updateArticleField('${pathString}', 'key', this.value)"
                                    onkeydown="handleArticleFieldInputKey(event, '${pathString}', 'key')">
                                
                                <input type="text" class="field-value-input ${isExpandable ? 'object-mode' : ''}" 
                                    placeholder="Value" value="${escapeHtml(node.value)}" 
                                    oninput="updateArticleField('${pathString}', 'value', this.value)"
                                    onkeydown="handleArticleFieldInputKey(event, '${pathString}', 'value')"
                                    ${isExpandable ? 'disabled title="Object/Array memiliki children"' : ''}>
                                
                                <select class="field-type-select" onchange="updateArticleField('${pathString}', 'type', this.value)">
                                    <option value="string" ${node.type === 'string' ? 'selected' : ''}>String</option>
                                    <option value="number" ${node.type === 'number' ? 'selected' : ''}>Number</option>
                                    <option value="boolean" ${node.type === 'boolean' ? 'selected' : ''}>Boolean</option>
                                    <option value="object" ${node.type === 'object' ? 'selected' : ''}>Object</option>
                                    <option value="array" ${node.type === 'array' ? 'selected' : ''}>Array</option>
                                    <option value="null" ${node.type === 'null' ? 'selected' : ''}>Null</option>
                                </select>
                            </div>

                            <div class="field-actions">
                                ${isExpandable ? `
                                    <button class="icon-btn add-child" onclick="addArticleChildField('${pathString}')" title="Tambah child">
                                        <span class="material-symbols-rounded">add</span>
                                    </button>
                                ` : ''}
                                <button class="icon-btn copy" onclick="duplicateArticleField('${pathString}')" title="Duplikat">
                                    <span class="material-symbols-rounded">content_copy</span>
                                </button>
                                <button class="icon-btn delete" onclick="deleteArticleField('${pathString}')" title="Hapus">
                                    <span class="material-symbols-rounded">delete</span>
                                </button>
                            </div>
                        </div>
                        
                        ${hasChildren ? `
                            <div class="field-children ${childrenClass}">
                                ${renderArticleFieldNodes(node.children, depth + 1, currentPath)}
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        function handleArticleFieldInputKey(event, path, field) {
            if (event.key === 'Enter') {
                event.target.blur();
            }
        }

        function attachArticleFieldDragHandlers() {
            const items = document.querySelectorAll('.article-field-content');
            items.forEach(item => {
                item.addEventListener('dragstart', handleArticleFieldDragStart);
                item.addEventListener('dragend', handleArticleFieldDragEnd);
                item.addEventListener('dragover', handleArticleFieldDragOver);
                item.addEventListener('drop', handleArticleFieldDrop);
                item.addEventListener('dragenter', handleArticleFieldDragEnter);
                item.addEventListener('dragleave', handleArticleFieldDragLeave);
            });
        }

        function handleArticleFieldDragStart(e) {
            draggedArticleField = this;
            draggedArticlePath = this.dataset.path;
            this.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/plain', draggedArticlePath);
        }

        function handleArticleFieldDragEnd(e) {
            this.classList.remove('dragging');
            document.querySelectorAll('.article-field-content').forEach(item => {
                item.classList.remove('drag-over');
            });
            draggedArticleField = null;
            draggedArticlePath = null;
        }

        function handleArticleFieldDragOver(e) {
            if (e.preventDefault) {
                e.preventDefault();
            }
            e.dataTransfer.dropEffect = 'move';
            return false;
        }

        function handleArticleFieldDragEnter(e) {
            if (this !== draggedArticleField) {
                this.classList.add('drag-over');
            }
        }

        function handleArticleFieldDragLeave(e) {
            this.classList.remove('drag-over');
        }

        function handleArticleFieldDrop(e) {
            if (e.stopPropagation) {
                e.stopPropagation();
            }
            
            if (draggedArticleField !== this) {
                const sourcePath = draggedArticlePath.split('-').map(Number);
                const targetPath = this.dataset.path.split('-').map(Number);
                
                const sourceResult = getArticleFieldByPath(sourcePath);
                if (!sourceResult) return;
                
                const sourceNode = sourceResult.node;
                
                if (sourceResult.isRoot) {
                    articleFields.splice(sourcePath[0], 1);
                } else {
                    const parentPath = sourcePath.slice(0, -1);
                    const parentResult = getArticleFieldByPath(parentPath);
                    if (parentResult && parentResult.node.children) {
                        parentResult.node.children.splice(sourcePath[sourcePath.length - 1], 1);
                    }
                }
                
                if (targetPath.length === 1) {
                    articleFields.splice(targetPath[0], 0, sourceNode);
                } else {
                    const targetParentPath = targetPath.slice(0, -1);
                    const targetParentResult = getArticleFieldByPath(targetParentPath);
                    if (targetParentResult && targetParentResult.node.children) {
                        targetParentResult.node.children.splice(targetPath[targetPath.length - 1], 0, sourceNode);
                    }
                }
                
                renderArticleFields();
                updateArticleOutput();
                showSnackbar('Field dipindahkan');
            }
            
            return false;
        }

        function toggleArticleField(pathString) {
            const path = pathString.split('-').map(Number);
            const result = getArticleFieldByPath(path);
            if (result && result.node) {
                result.node.expanded = !result.node.expanded;
                renderArticleFields();
            }
        }

        function updateArticleField(pathString, property, value) {
            const path = pathString.split('-').map(Number);
            const result = getArticleFieldByPath(path);
            
            if (!result || !result.node) {
                console.error('Field not found at path:', path);
                return;
            }
            
            const node = result.node;
            
            if (property === 'type') {
                const oldType = node.type;
                node.type = value;
                
                if ((value === 'object' || value === 'array') && !node.children) {
                    node.children = [];
                    node.expanded = true;
                }
                
                if ((oldType === 'object' || oldType === 'array') && 
                    (value !== 'object' && value !== 'array')) {
                    node.children = [];
                    node.value = '';
                }
                
                renderArticleFields();
            } else {
                node[property] = value;
            }
            
            updateArticleOutput();
        }

        function addArticleRootField() {
            const newNode = {
                id: generateArticleFieldId(),
                key: '',
                value: '',
                type: 'string',
                expanded: true,
                children: []
            };
            articleFields.push(newNode);
            renderArticleFields();
            updateArticleOutput();
            
            setTimeout(() => {
                const inputs = document.querySelectorAll('.field-key-input');
                if (inputs.length > 0) {
                    inputs[inputs.length - 1].focus();
                }
            }, 100);
        }

        function addArticleChildField(pathString) {
            const path = pathString.split('-').map(Number);
            const result = getArticleFieldByPath(path);
            
            if (!result || !result.node) return;
            
            const node = result.node;
            
            if (!node.children) {
                node.children = [];
            }
            
            const newChild = {
                id: generateArticleFieldId(),
                key: '',
                value: '',
                type: 'string',
                expanded: true,
                children: []
            };
            
            node.children.push(newChild);
            node.expanded = true;
            renderArticleFields();
            updateArticleOutput();
        }

        function duplicateArticleField(pathString) {
            const path = pathString.split('-').map(Number);
            const result = getArticleFieldByPath(path);
            
            if (!result || !result.node) return;
            
            const node = result.node;
            const clonedNode = JSON.parse(JSON.stringify(node));
            
            function updateIds(n) {
                n.id = generateArticleFieldId();
                if (n.children) {
                    n.children.forEach(updateIds);
                }
            }
            updateIds(clonedNode);
            
            if (result.isRoot) {
                articleFields.splice(path[0] + 1, 0, clonedNode);
            } else {
                const parentPath = path.slice(0, -1);
                const parentResult = getArticleFieldByPath(parentPath);
                if (parentResult && parentResult.node.children) {
                    parentResult.node.children.splice(path[path.length - 1] + 1, 0, clonedNode);
                }
            }
            
            renderArticleFields();
            updateArticleOutput();
        }

        function deleteArticleField(pathString) {
            const path = pathString.split('-').map(Number);
            const result = getArticleFieldByPath(path);
            
            if (!result || !result.node) return;
            
            showDialog(
                'Hapus Field?',
                'Anda yakin ingin menghapus field ini dan semua children-nya?',
                () => {
                    if (result.isRoot) {
                        articleFields.splice(path[0], 1);
                    } else {
                        const parentPath = path.slice(0, -1);
                        const parentResult = getArticleFieldByPath(parentPath);
                        if (parentResult && parentResult.node.children) {
                            parentResult.node.children.splice(path[path.length - 1], 1);
                        }
                    }
                    renderArticleFields();
                    updateArticleOutput();
                }
            );
        }

        function expandAllArticleFields() {
            function expand(node) {
                node.expanded = true;
                if (node.children) {
                    node.children.forEach(expand);
                }
            }
            articleFields.forEach(expand);
            renderArticleFields();
        }

        function collapseAllArticleFields() {
            function collapse(node) {
                node.expanded = false;
                if (node.children) {
                    node.children.forEach(collapse);
                }
            }
            articleFields.forEach(collapse);
            renderArticleFields();
        }

        function clearAllArticleFields() {
            if (articleFields.length === 0) return;
            
            showDialog(
                'Hapus Semua Field?',
                `Anda yakin ingin menghapus ${countAllArticleFields(articleFields)} field?`,
                () => {
                    articleFields = [];
                    renderArticleFields();
                    updateArticleOutput();
                    document.getElementById('generated-prompt-area').textContent = 'Prompt akan muncul di sini setelah klik "Generate"';
                }
            );
        }

        function countAllArticleFields(nodes) {
            let count = nodes.length;
            nodes.forEach(node => {
                if (node.children) {
                    count += countAllArticleFields(node.children);
                }
            });
            return count;
        }

        function updateArticleFieldCount() {
            document.getElementById('articleFieldCount').textContent = countAllArticleFields(articleFields);
        }

        function addPresetField(presetType) {
            const preset = presetFieldDefinitions[presetType];
            const newNode = {
                id: generateArticleFieldId(),
                key: preset.key,
                value: preset.value,
                type: preset.type,
                expanded: true,
                children: []
            };
            articleFields.push(newNode);
            renderArticleFields();
            updateArticleOutput();
            showSnackbar(`Field "${preset.key}" ditambahkan`);
        }

        function switchFieldTab(tab) {
            document.querySelectorAll('.field-editor-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.field-editor-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tab + '-tab').classList.add('active');
        }

        function loadArticlePreset(presetName) {
            if (articleFields.length > 0) {
                showDialog(
                    'Load Preset',
                    'Field yang ada akan digantikan. Lanjutkan?',
                    () => {
                        applyArticlePreset(presetName);
                    }
                );
            } else {
                applyArticlePreset(presetName);
            }
        }

        function applyArticlePreset(presetName) {
            articleFields = JSON.parse(JSON.stringify(articlePresets[presetName]));
            
            function updateIds(node) {
                node.id = generateArticleFieldId();
                if (node.children) {
                    node.children.forEach(updateIds);
                }
            }
            articleFields.forEach(updateIds);
            
            document.querySelectorAll('#presets-tab .chip').forEach(chip => {
                chip.classList.remove('active');
            });
            event.target.classList.add('active');
            
            renderArticleFields();
            updateArticleOutput();
            
            const presetNames = {
                'empty': 'Empty',
                'general': 'Umum',
                'blog': 'Blog Post',
                'coding': 'Coding',
                'storytelling': 'Storytelling',
                'email': 'Email Marketing'
            };
            showSnackbar(`Preset "${presetNames[presetName]}" dimuat`);
            
            // Switch back to fields tab
            document.querySelectorAll('.field-editor-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.field-editor-content').forEach(c => c.classList.remove('active'));
            document.querySelector('.field-editor-tab:first-child').classList.add('active');
            document.getElementById('fields-tab').classList.add('active');
        }

        function generateArticleJSON() {
            function convertNode(node) {
                let value;
                
                switch(node.type) {
                    case 'number':
                        value = parseFloat(node.value) || 0;
                        break;
                    case 'boolean':
                        value = node.value.toLowerCase() === 'true' || node.value === true || node.value === '1';
                        break;
                    case 'null':
                        value = null;
                        break;
                    case 'object':
                        value = {};
                        if (node.children) {
                            node.children.forEach(child => {
                                value[child.key] = convertNode(child);
                            });
                        }
                        break;
                    case 'array':
                        value = [];
                        if (node.children) {
                            node.children.forEach(child => {
                                value.push(convertNode(child));
                            });
                        }
                        break;
                    default:
                        value = node.value;
                }
                
                return value;
            }

            const result = {};
            articleFields.forEach(node => {
                result[node.key] = convertNode(node);
            });
            
            return result;
        }

        function updateArticleOutput() {
            const json = generateArticleJSON();
            const jsonString = JSON.stringify(json, null, 2);
            
            const highlighted = jsonString
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?)/g, (match) => {
                    let cls = 'json-string';
                    if (/:\s*$/.test(match)) {
                        cls = 'json-key';
                        return `<span class="${cls}">${match}</span>`;
                    }
                    return `<span class="${cls}">${match}</span>`;
                })
                .replace(/\b(true|false)\b/g, '<span class="json-boolean">$1</span>')
                .replace(/\b(null)\b/g, '<span class="json-boolean">$1</span>')
                .replace(/\b(\d+\.?\d*)\b/g, '<span class="json-number">$1</span>');
            
            document.getElementById('article-json-code').innerHTML = highlighted;
            validateArticleJSON();
        }

        function validateArticleJSON() {
            try {
                const json = generateArticleJSON();
                JSON.stringify(json);
                document.getElementById('article-validation-status').innerHTML = `
                    <span class="material-symbols-rounded" style="vertical-align: middle; margin-right: 8px; color: var(--md-sys-color-primary);">check_circle</span>
                    Struktur valid - Siap generate prompt
                `;
                return true;
            } catch(e) {
                document.getElementById('article-validation-status').innerHTML = `
                    <span class="material-symbols-rounded" style="vertical-align: middle; margin-right: 8px; color: var(--md-sys-color-error);">error</span>
                    Error: ${e.message}
                `;
                return false;
            }
        }

        function generateFromFields() {
            const json = generateArticleJSON();
            
            if (Object.keys(json).length === 0) {
                showSnackbar('Tidak ada field untuk digenerate!');
                return;
            }

            const styleLabels = {
                'formal': 'formal dan profesional',
                'casual': 'santai dan mudah dipahami',
                'professional': 'profesional dengan data akurat',
                'creative': 'kreatif dan imajinatif',
                'academic': 'akademis dengan referensi',
                'persuasive': 'persuasif dan konversi',
                'humorous': 'humoris dan menghibur'
            };

            const topicLabels = {
                'general': 'Artikel/Berita Umum',
                'blog': 'Blog Post',
                'coding': 'Tutorial/Kode',
                'storytelling': 'Cerita/Naratif',
                'email': 'Email Marketing'
            };

            let prompt = `Anda adalah ${json.ai_role || 'seorang penulis profesional'}. `;
            
            if (json.topic && topicLabels[json.topic]) {
                prompt += `Buatlah ${topicLabels[json.topic]} `;
            }
            
            if (json.language_style && styleLabels[json.language_style]) {
                prompt += `dengan gaya bahasa ${styleLabels[json.language_style]}. `;
            }
            
            if (json.target_audience) {
                prompt += `Target audiens Anda adalah ${json.target_audience}. `;
            }

            prompt += `\n\nTUGAS UTAMA:\n${json.main_task || 'Buat konten sesuai spesifikasi.'}\n\n`;

            if (json.word_limit) {
                prompt += `PANJANG TEKS: Maksimal ${json.word_limit} kata.\n\n`;
            }

            if (json.output_format) {
                prompt += `FORMAT OUTPUT: ${json.output_format}.\n\n`;
            }

            // Add any additional fields
            const skipFields = ['topic', 'ai_role', 'language_style', 'target_audience', 'main_task', 'word_limit', 'output_format'];
            const extraFields = Object.keys(json).filter(key => !skipFields.includes(key));
            
            if (extraFields.length > 0) {
                prompt += `SPESIFIKASI TAMBAHAN:\n`;
                extraFields.forEach(key => {
                    prompt += `- ${key}: ${json[key]}\n`;
                });
                prompt += `\n`;
            }

            prompt += `INSTRUKSI PENTING:
- Output harus akurat, rapi, dan langsung ke inti tanpa pengantar berlebihan
- Hindari pengulangan informasi yang tidak perlu
- Pastikan konten original dan berkualitas tinggi
- Gunakan paragraf yang terstruktur dengan baik`;

            document.getElementById('generated-prompt-area').textContent = prompt;
            showSnackbar('Prompt berhasil digenerate!');
        }

        function copyArticleOutput() {
            const codeElement = document.getElementById('article-json-code');
            const text = codeElement.textContent;
            
            if (!text || text === '{}') {
                showSnackbar('Belum ada hasil untuk disalin!');
                return;
            }
            
            navigator.clipboard.writeText(text).then(() => {
                showSnackbar('JSON disalin ke clipboard!');
            }).catch(() => {
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showSnackbar('JSON disalin ke clipboard!');
            });
        }

        function downloadArticleJSON() {
            const codeElement = document.getElementById('article-json-code');
            const text = codeElement.textContent;
            
            if (!text || text === '{}') {
                showSnackbar('Belum ada hasil untuk diunduh!');
                return;
            }
            
            const blob = new Blob([text], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'article-config.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showSnackbar('File JSON diunduh!');
        }

        function copyGeneratedPrompt() {
            const promptArea = document.getElementById('generated-prompt-area');
            const text = promptArea.textContent;
            
            if (!text || text.includes('Prompt akan muncul di sini')) {
                showSnackbar('Belum ada prompt untuk disalin!');
                return;
            }
            
            navigator.clipboard.writeText(text).then(() => {
                showSnackbar('Prompt disalin ke clipboard!');
            }).catch(() => {
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showSnackbar('Prompt disalin ke clipboard!');
            });
        }

        // Common Functions
        function showSnackbar(message) {
            const snackbar = document.getElementById('snackbar');
            document.getElementById('snackbarText').textContent = message;
            snackbar.classList.add('show');
            setTimeout(() => {
                snackbar.classList.remove('show');
            }, 3000);
        }

        function showDialog(title, content, onConfirm, confirmText = 'OK') {
            document.getElementById('dialogTitle').textContent = title;
            document.getElementById('dialogContent').innerHTML = content;
            document.getElementById('dialog').classList.add('active');
            
            const confirmBtn = document.getElementById('dialogConfirm');
            if (onConfirm) {
                confirmBtn.style.display = 'inline-flex';
                confirmBtn.textContent = confirmText;
                window.dialogCallback = onConfirm;
            } else {
                confirmBtn.style.display = 'none';
            }
        }

        function closeDialog(e) {
            if (!e || e.target.id === 'dialog') {
                document.getElementById('dialog').classList.remove('active');
            }
        }

        function confirmDialog() {
            closeDialog();
            if (window.dialogCallback) {
                window.dialogCallback();
                window.dialogCallback = null;
            }
        }

        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            
            const icon = document.querySelector('.app-bar-actions .icon-btn .material-symbols-rounded');
            icon.textContent = newTheme === 'dark' ? 'light_mode' : 'dark_mode';
            
            showSnackbar(`Tema ${newTheme === 'dark' ? 'gelap' : 'terang'} aktif`);
        }

        function showHelp() {
            showDialog(
                'Bantuan',
                `
                <div style="line-height: 1.8;">
                    <p><strong>Dua Tools Tersedia:</strong></p>
                    <p><strong>1. JSON Builder:</strong> Buat dan edit struktur JSON hierarkis dengan drag-drop.</p>
                    <p><strong>2. Article Generator:</strong> Buat konfigurasi artikel dengan field editor yang fleksibel.</p>
                    <br>
                    <p><strong>Fitur Article Generator:</strong></p>
                    <ul style="margin-left: 20px;">
                        <li>Edit Fields: Tambah, hapus, edit field dengan tipe data beragam</li>
                        <li>Preset Templates: Pilih dari 5 template siap pakai</li>
                        <li>Drag & Drop: Urutkan ulang field sesuai kebutuhan</li>
                        <li>Nested Structure: Buat Object/Array dengan child fields</li>
                        <li>Live Preview: JSON update otomatis saat field berubah</li>
                        <li>Generate Prompt: Konversi field menjadi teks prompt</li>
                    </ul>
                </div>
                `,
                null,
                'Mengerti'
            );
        }

        function switchTool(tool) {
            document.querySelectorAll('.tool-nav-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tool-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tool + '-tool').classList.add('active');
            
            showSnackbar(`Beralih ke ${tool === 'json' ? 'JSON Builder' : 'Article Generator'}`);
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    if (document.getElementById('json-tool').classList.contains('active')) {
                        addRootNode();
                    } else {
                        addArticleRootField();
                    }
                } else if (e.key === 's') {
                    e.preventDefault();
                    if (document.getElementById('json-tool').classList.contains('active')) {
                        downloadJSON();
                    } else {
                        downloadArticleJSON();
                    }
                }
            }
        });

        // Touch event improvements for mobile drag and drop
        let touchStartY = 0;
        let touchStartX = 0;

        document.addEventListener('touchstart', (e) => {
            touchStartY = e.touches[0].clientY;
            touchStartX = e.touches[0].clientX;
        }, { passive: true });

        document.addEventListener('touchmove', (e) => {
            if (!draggedNode && !draggedArticleField) return;
            
            const touchY = e.touches[0].clientY;
            const touchX = e.touches[0].clientX;
            
            // Prevent scrolling while dragging
            if (Math.abs(touchY - touchStartY) > 10 || Math.abs(touchX - touchStartX) > 10) {
                e.preventDefault();
            }
        }, { passive: false });
    </script>
</body>
</html>
