<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Undangan Karang Taruna Wonolobo</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style id="theme-style">
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f7fa;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 30px auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border-radius: 12px;
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #6200ea 0%, #3700b3 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }
        .header h1 {
            margin: 0;
            font-size: 28px;
            font-weight: 500;
            letter-spacing: 0.5px;
        }
        .header p {
            margin: 10px 0 0 0;
            font-weight: 300;
            opacity: 0.9;
        }
        .content {
            background-color: white;
            padding: 30px;
            line-height: 1.8;
        }
        .content p {
            margin: 0 0 16px 0;
        }
        .content table {
            width: 100%;
            margin-bottom: 16px;
        }
        .content td {
            padding: 8px 0;
        }
        .footer {
            background-color: white;
            padding: 40px 30px 30px 30px;
            text-align: right;
            border-top: 1px solid #eee;
        }
        .material-card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            padding: 20px;
            margin-bottom: 20px;
        }
        .controls {
            max-width: 800px;
            margin: 30px auto;
            padding: 20px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
            font-size: 14px;
        }
        .form-group input, .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-family: 'Roboto', sans-serif;
            font-size: 16px;
            transition: all 0.3s;
        }
        .form-group input:focus, .form-group textarea:focus {
            outline: none;
            border-color: #6200ea;
            box-shadow: 0 0 0 2px rgba(98, 0, 234, 0.2);
        }
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-family: 'Roboto', sans-serif;
            font-size: 14px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            margin-right: 10px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        .btn i {
            margin-right: 8px;
            font-size: 18px;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        .primary-btn {
            background-color: #6200ea;
            color: white;
        }
        .primary-btn:hover {
            background-color: #5a00d2;
        }
        .theme-select {
            padding: 12px 16px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-family: 'Roboto', sans-serif;
            font-size: 16px;
            margin-right: 10px;
            background-color: white;
        }
        .section-title {
            font-size: 18px;
            font-weight: 500;
            margin: 20px 0 15px 0;
            color: #444;
            display: flex;
            align-items: center;
        }
        .section-title i {
            margin-right: 10px;
            color: #6200ea;
        }
        .signature {
            margin-top: 60px;
        }
        .controls-header {
            font-size: 20px;
            font-weight: 500;
            margin-bottom: 20px;
            color: #333;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        .whatsapp-link {
  display: inline-block;
  background-color: #25D366;
  color: white;
  padding: 10px 15px;
  border-radius: 5px;
  text-decoration: none;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  font-size: 14px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.2);
  transition: background-color 0.3s ease;
}

.whatsapp-link:hover {
  background-color: #128C7E;
    </style>
</head>
<body>
    <a class="whatsapp-link" href="/">Home</a>
    <div class="controls">
        <h2 class="controls-header">üìù Edit Undangan Karang Taruna</h2>
        
        <div class="material-card">
            <h3 class="section-title"><i class="material-icons">edit</i> Informasi Undangan</h3>
            <div class="form-group">
                <label for="judul">Judul Undangan</label>
                <input type="text" id="judul" value="UNDANGAN RAPAT RUTIN KARANG TARUNA">
            </div>
            <div class="form-group">
                <label for="dusun">Nama Dusun</label>
                <input type="text" id="dusun" value="Dusun Wonolobo">
            </div>
            <div class="form-group">
                <label for="tanggal">Tanggal Acara</label>
                <input type="text" id="tanggal" value="Sabtu, 10 Juni 2024">
            </div>
            <div class="form-group">
                <label for="waktu">Waktu Acara</label>
                <input type="text" id="waktu" value="Pukul 19.30 WIB - selesai">
            </div>
            <div class="form-group">
                <label for="tempat">Tempat Acara</label>
                <input type="text" id="tempat" value="Balai Dusun Wonolobo">
            </div>
            <div class="form-group">
                <label for="acara">Jenis Acara</label>
                <input type="text" id="acara" value="Rapat Rutin Bulanan Karang Taruna">
            </div>
            <div class="form-group">
                <label for="keterangan">Keterangan Tambahan</label>
                <textarea id="keterangan" rows="3">Diharapkan kehadiran seluruh anggota Karang Taruna Dusun Wonolobo. Acara dimulai tepat waktu. Mohon membawa buku catatan dan pena.</textarea>
            </div>
        </div>
        
        <div class="material-card">
            <h3 class="section-title"><i class="material-icons">person</i> Informasi Penandatangan</h3>
            <div class="form-group">
                <label for="ttd">Jabatan Penandatangan</label>
                <input type="text" id="ttd" value="Ketua Karang Taruna Dusun Wonolobo">
            </div>
            <div class="form-group">
                <label for="namaTtd">Nama Penandatangan</label>
                <input type="text" id="namaTtd" value="Ahmad Fauzi">
            </div>
        </div>
        
        <div class="material-card">
            <h3 class="section-title"><i class="material-icons">palette</i> Tema Warna</h3>
            <div style="display: flex; align-items: center; margin-bottom: 20px;">
                <label for="theme-select" style="margin-right: 10px; white-space: nowrap;">Pilih Tema:</label>
                <select id="theme-select" class="theme-select">
                    <option value="elegant-purple">Tema Ungu Elegan (Default)</option>
                    <option value="merah-putih">Tema Merah Putih</option>
                    <option value="whatsapp">Tema WhatsApp</option>
                    <option value="facebook">Tema Facebook</option>
                    <option value="reddit">Tema Reddit</option>
                    <option value="forest">Tema Forest</option>
                    <option value="miku">Tema Hatsune Miku</option>
                </select>
            </div>
            
            <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                <button id="apply-btn" class="btn primary-btn">
                    <i class="material-icons">color_lens</i> Terapkan Tema
                </button>
                <button id="download-btn" class="btn" style="background-color: #007bff; color: white;">
                    <i class="material-icons">picture_as_pdf</i> Unduh PDF
                </button>
                <button id="download-html-btn" class="btn" style="background-color: #28a745; color: white;">
                    <i class="material-icons">code</i> Unduh HTML
                </button>
            </div>
        </div>
    </div>

    <div class="container" id="document">
        <div class="header" id="doc-header">
            <h1 id="doc-judul">UNDANGAN RAPAT RUTIN KARANG TARUNA</h1>
            <p><span id="doc-dusun">Dusun Wonolobo</span></p>
        </div>
        
        <div class="content">
            <p>Kepada Yth.</p>
            <p>Seluruh Anggota Karang Taruna</p>
            <p><span id="doc-dusun2">Dusun Wonolobo</span></p>
            <p>Di Tempat</p>
            
            <p>Dengan hormat,</p>
            
            <p>Kami mengundang Bapak/Ibu/Saudara(i) untuk hadir dalam acara:</p>
            
            <table>
                <tr>
                    <td width="30%"><strong>Hari/Tanggal</strong></td>
                    <td width="5%">:</td>
                    <td width="65%"><span id="doc-tanggal">Sabtu, 10 Juni 2024</span></td>
                </tr>
                <tr>
                    <td><strong>Waktu</strong></td>
                    <td>:</td>
                    <td><span id="doc-waktu">Pukul 19.30 WIB - selesai</span></td>
                </tr>
                <tr>
                    <td><strong>Tempat</strong></td>
                    <td>:</td>
                    <td><span id="doc-tempat">Balai Dusun Wonolobo</span></td>
                </tr>
                <tr>
                    <td><strong>Acara</strong></td>
                    <td>:</td>
                    <td><span id="doc-acara">Rapat Rutin Bulanan Karang Taruna</span></td>
                </tr>
            </table>
            
            <p><strong>Keterangan:</strong></p>
            <p id="doc-keterangan">Diharapkan kehadiran seluruh anggota Karang Taruna Dusun Wonolobo. Acara dimulai tepat waktu. Mohon membawa buku catatan dan pena.</p>
            
            <p>Demikian undangan ini kami sampaikan. Atas perhatian dan kehadirannya, kami ucapkan terima kasih.</p>
        </div>
        
        <div class="footer">
            <p id="doc-ttd">Ketua Karang Taruna Dusun Wonolobo</p>
            <div class="signature">
                <p><u id="doc-namaTtd">Ahmad Fauzi</u></p>
            </div>
        </div>
    </div>

    <script>
        // Update document from form
        function updateDocument() {
            document.getElementById('doc-judul').textContent = document.getElementById('judul').value;
            document.getElementById('doc-dusun').textContent = document.getElementById('dusun').value;
            document.getElementById('doc-dusun2').textContent = document.getElementById('dusun').value;
            document.getElementById('doc-tanggal').textContent = document.getElementById('tanggal').value;
            document.getElementById('doc-waktu').textContent = document.getElementById('waktu').value;
            document.getElementById('doc-tempat').textContent = document.getElementById('tempat').value;
            document.getElementById('doc-acara').textContent = document.getElementById('acara').value;
            document.getElementById('doc-keterangan').textContent = document.getElementById('keterangan').value;
            document.getElementById('doc-ttd').textContent = document.getElementById('ttd').value;
            document.getElementById('doc-namaTtd').textContent = document.getElementById('namaTtd').value;
        }

        // Apply theme
        function applyTheme() {
            const theme = document.getElementById('theme-select').value;
            const style = document.getElementById('theme-style');
            const header = document.getElementById('doc-header');
            
            let css = '';
            let headerGradient = '';
            
            switch(theme) {
                case 'merah-putih':
                    headerGradient = 'linear-gradient(135deg, #D62828 0%, #9B2226 100%)';
                    css = `
                        body { font-family: 'Roboto', sans-serif; margin: 0; padding: 0; background-color: #f8f9fa; color: #333; }
                        .container { max-width: 800px; margin: 30px auto; box-shadow: 0 4px 20px rgba(0,0,0,0.1); border-radius: 12px; overflow: hidden; }
                        .header { background: ${headerGradient}; color: white; padding: 30px; text-align: center; position: relative; }
                        .header h1 { margin: 0; font-size: 28px; font-weight: 500; letter-spacing: 0.5px; }
                        .header p { margin: 10px 0 0 0; font-weight: 300; opacity: 0.9; }
                        .content { background-color: white; padding: 30px; line-height: 1.8; }
                        .content p { margin: 0 0 16px 0; }
                        .content table { width: 100%; margin-bottom: 16px; }
                        .content td { padding: 8px 0; }
                        .footer { background-color: white; padding: 40px 30px 30px 30px; text-align: right; border-top: 1px solid #eee; }
                        .material-card { background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); padding: 20px; margin-bottom: 20px; }
                        .controls { max-width: 800px; margin: 30px auto; padding: 20px; background-color: white; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
                        .form-group label { display: block; margin-bottom: 8px; font-weight: 500; color: #555; font-size: 14px; }
                        .form-group input, .form-group textarea { width: 100%; padding: 12px 16px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Roboto', sans-serif; font-size: 16px; transition: all 0.3s; }
                        .form-group input:focus, .form-group textarea:focus { outline: none; border-color: #D62828; box-shadow: 0 0 0 2px rgba(214, 40, 40, 0.2); }
                        .btn { padding: 12px 24px; border: none; border-radius: 8px; font-family: 'Roboto', sans-serif; font-size: 14px; font-weight: 500; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; transition: all 0.3s; box-shadow: 0 2px 5px rgba(0,0,0,0.2); margin-right: 10px; display: inline-flex; align-items: center; justify-content: center; }
                        .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.3); }
                        .primary-btn { background-color: #D62828; color: white; }
                        .primary-btn:hover { background-color: #c02020; }
                        .theme-select { padding: 12px 16px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Roboto', sans-serif; font-size: 16px; margin-right: 10px; background-color: white; }
                        .section-title { font-size: 18px; font-weight: 500; margin: 20px 0 15px 0; color: #444; display: flex; align-items: center; }
                        .section-title i { margin-right: 10px; color: #D62828; }
                        .signature { margin-top: 60px; }
                        .controls-header { font-size: 20px; font-weight: 500; margin-bottom: 20px; color: #333; padding-bottom: 10px; border-bottom: 2px solid #f0f0f0; }
                    `;
                    break;
                    
                case 'whatsapp':
                    headerGradient = 'linear-gradient(135deg, #128C7E 0%, #075E54 100%)';
                    css = `
                        body { font-family: 'Roboto', sans-serif; margin: 0; padding: 0; background-color: #f8f9fa; color: #333; }
                        .container { max-width: 800px; margin: 30px auto; box-shadow: 0 4px 20px rgba(0,0,0,0.1); border-radius: 12px; overflow: hidden; }
                        .header { background: ${headerGradient}; color: white; padding: 30px; text-align: center; position: relative; }
                        .header h1 { margin: 0; font-size: 28px; font-weight: 500; letter-spacing: 0.5px; }
                        .header p { margin: 10px 0 0 0; font-weight: 300; opacity: 0.9; }
                        .content { background-color: white; padding: 30px; line-height: 1.8; }
                        .content p { margin: 0 0 16px 0; }
                        .content table { width: 100%; margin-bottom: 16px; }
                        .content td { padding: 8px 0; }
                        .footer { background-color: white; padding: 40px 30px 30px 30px; text-align: right; border-top: 1px solid #eee; }
                        .material-card { background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); padding: 20px; margin-bottom: 20px; }
                        .controls { max-width: 800px; margin: 30px auto; padding: 20px; background-color: white; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
                        .form-group label { display: block; margin-bottom: 8px; font-weight: 500; color: #555; font-size: 14px; }
                        .form-group input, .form-group textarea { width: 100%; padding: 12px 16px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Roboto', sans-serif; font-size: 16px; transition: all 0.3s; }
                        .form-group input:focus, .form-group textarea:focus { outline: none; border-color: #128C7E; box-shadow: 0 0 0 2px rgba(18, 140, 126, 0.2); }
                        .btn { padding: 12px 24px; border: none; border-radius: 8px; font-family: 'Roboto', sans-serif; font-size: 14px; font-weight: 500; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; transition: all 0.3s; box-shadow: 0 2px 5px rgba(0,0,0,0.2); margin-right: 10px; display: inline-flex; align-items: center; justify-content: center; }
                        .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.3); }
                        .primary-btn { background-color: #128C7E; color: white; }
                        .primary-btn:hover { background-color: #107c6e; }
                        .theme-select { padding: 12px 16px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Roboto', sans-serif; font-size: 16px; margin-right: 10px; background-color: white; }
                        .section-title { font-size: 18px; font-weight: 500; margin: 20px 0 15px 0; color: #444; display: flex; align-items: center; }
                        .section-title i { margin-right: 10px; color: #128C7E; }
                        .signature { margin-top: 60px; }
                        .controls-header { font-size: 20px; font-weight: 500; margin-bottom: 20px; color: #333; padding-bottom: 10px; border-bottom: 2px solid #f0f0f0; }
                    `;
                    break;
                    
                case 'facebook':
                    headerGradient = 'linear-gradient(135deg, #1877f2 0%, #0a66c2 100%)';
                    css = `
                        body { font-family: 'Roboto', sans-serif; margin: 0; padding: 0; background-color: #f8f9fa; color: #333; }
                        .container { max-width: 800px; margin: 30px auto; box-shadow: 0 4px 20px rgba(0,0,0,0.1); border-radius: 12px; overflow: hidden; }
                        .header { background: ${headerGradient}; color: white; padding: 30px; text-align: center; position: relative; }
                        .header h1 { margin: 0; font-size: 28px; font-weight: 500; letter-spacing: 0.5px; }
                        .header p { margin: 10px 0 0 0; font-weight: 300; opacity: 0.9; }
                        .content { background-color: white; padding: 30px; line-height: 1.8; }
                        .content p { margin: 0 0 16px 0; }
                        .content table { width: 100%; margin-bottom: 16px; }
                        .content td { padding: 8px 0; }
                        .footer { background-color: white; padding: 40px 30px 30px 30px; text-align: right; border-top: 1px solid #eee; }
                        .material-card { background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); padding: 20px; margin-bottom: 20px; }
                        .controls { max-width: 800px; margin: 30px auto; padding: 20px; background-color: white; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
                        .form-group label { display: block; margin-bottom: 8px; font-weight: 500; color: #555; font-size: 14px; }
                        .form-group input, .form-group textarea { width: 100%; padding: 12px 16px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Roboto', sans-serif; font-size: 16px; transition: all 0.3s; }
                        .form-group input:focus, .form-group textarea:focus { outline: none; border-color: #1877f2; box-shadow: 0 0 0 2px rgba(24, 119, 242, 0.2); }
                        .btn { padding: 12px 24px; border: none; border-radius: 8px; font-family: 'Roboto', sans-serif; font-size: 14px; font-weight: 500; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; transition: all 0.3s; box-shadow: 0 2px 5px rgba(0,0,0,0.2); margin-right: 10px; display: inline-flex; align-items: center; justify-content: center; }
                        .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.3); }
                        .primary-btn { background-color: #1877f2; color: white; }
                        .primary-btn:hover { background-color: #166fe5; }
                        .theme-select { padding: 12px 16px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Roboto', sans-serif; font-size: 16px; margin-right: 10px; background-color: white; }
                        .section-title { font-size: 18px; font-weight: 500; margin: 20px 0 15px 0; color: #444; display: flex; align-items: center; }
                        .section-title i { margin-right: 10px; color: #1877f2; }
                        .signature { margin-top: 60px; }
                        .controls-header { font-size: 20px; font-weight: 500; margin-bottom: 20px; color: #333; padding-bottom: 10px; border-bottom: 2px solid #f0f0f0; }
                    `;
                    break;
                    
                case 'reddit':
                    headerGradient = 'linear-gradient(135deg, #FF4500 0%, #D22E00 100%)';
                    css = `
                        body { font-family: 'Roboto', sans-serif; margin: 0; padding: 0; background-color: #f8f9fa; color: #333; }
                        .container { max-width: 800px; margin: 30px auto; box-shadow: 0 4px 20px rgba(0,0,0,0.1); border-radius: 12px; overflow: hidden; }
                        .header { background: ${headerGradient}; color: white; padding: 30px; text-align: center; position: relative; }
                        .header h1 { margin: 0; font-size: 28px; font-weight: 500; letter-spacing: 0.5px; }
                        .header p { margin: 10px 0 0 0; font-weight: 300; opacity: 0.9; }
                        .content { background-color: white; padding: 30px; line-height: 1.8; }
                        .content p { margin: 0 0 16px 0; }
                        .content table { width: 100%; margin-bottom: 16px; }
                        .content td { padding: 8px 0; }
                        .footer { background-color: white; padding: 40px 30px 30px 30px; text-align: right; border-top: 1px solid #eee; }
                        .material-card { background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); padding: 20px; margin-bottom: 20px; }
                        .controls { max-width: 800px; margin: 30px auto; padding: 20px; background-color: white; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
                        .form-group label { display: block; margin-bottom: 8px; font-weight: 500; color: #555; font-size: 14px; }
                        .form-group input, .form-group textarea { width: 100%; padding: 12px 16px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Roboto', sans-serif; font-size: 16px; transition: all 0.3s; }
                        .form-group input:focus, .form-group textarea:focus { outline: none; border-color: #FF4500; box-shadow: 0 0 0 2px rgba(255, 69, 0, 0.2); }
                        .btn { padding: 12px 24px; border: none; border-radius: 8px; font-family: 'Roboto', sans-serif; font-size: 14px; font-weight: 500; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; transition: all 0.3s; box-shadow: 0 2px 5px rgba(0,0,0,0.2); margin-right: 10px; display: inline-flex; align-items: center; justify-content: center; }
                        .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.3); }
                        .primary-btn { background-color: #FF4500; color: white; }
                        .primary-btn:hover { background-color: #e63e00; }
                        .theme-select { padding: 12px 16px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Roboto', sans-serif; font-size: 16px; margin-right: 10px; background-color: white; }
                        .section-title { font-size: 18px; font-weight: 500; margin: 20px 0 15px 0; color: #444; display: flex; align-items: center; }
                        .section-title i { margin-right: 10px; color: #FF4500; }
                        .signature { margin-top: 60px; }
                        .controls-header { font-size: 20px; font-weight: 500; margin-bottom: 20px; color: #333; padding-bottom: 10px; border-bottom: 2px solid #f0f0f0; }
                    `;
                    break;
                    
                case 'forest':
                    headerGradient = 'linear-gradient(135deg, #2D5016 0%, #1E3A10 100%)';
                    css = `
                        body { font-family: 'Roboto', sans-serif; margin: 0; padding: 0; background-color: #f8f9fa; color: #333; }
                        .container { max-width: 800px; margin: 30px auto; box-shadow: 0 4px 20px rgba(0,0,0,0.1); border-radius: 12px; overflow: hidden; }
                        .header { background: ${headerGradient}; color: white; padding: 30px; text-align: center; position: relative; }
                        .header h1 { margin: 0; font-size: 28px; font-weight: 500; letter-spacing: 0.5px; }
                        .header p { margin: 10px 0 0 0; font-weight: 300; opacity: 0.9; }
                        .content { background-color: white; padding: 30px; line-height: 1.8; }
                        .content p { margin: 0 0 16px 0; }
                        .content table { width: 100%; margin-bottom: 16px; }
                        .content td { padding: 8px 0; }
                        .footer { background-color: white; padding: 40px 30px 30px 30px; text-align: right; border-top: 1px solid #eee; }
                        .material-card { background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); padding: 20px; margin-bottom: 20px; }
                        .controls { max-width: 800px; margin: 30px auto; padding: 20px; background-color: white; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
                        .form-group label { display: block; margin-bottom: 8px; font-weight: 500; color: #555; font-size: 14px; }
                        .form-group input, .form-group textarea { width: 100%; padding: 12px 16px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Roboto', sans-serif; font-size: 16px; transition: all 0.3s; }
                        .form-group input:focus, .form-group textarea:focus { outline: none; border-color: #2D5016; box-shadow: 0 0 0 2px rgba(45, 80, 22, 0.2); }
                        .btn { padding: 12px 24px; border: none; border-radius: 8px; font-family: 'Roboto', sans-serif; font-size: 14px; font-weight: 500; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; transition: all 0.3s; box-shadow: 0 2px 5px rgba(0,0,0,0.2); margin-right: 10px; display: inline-flex; align-items: center; justify-content: center; }
                        .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.3); }
                        .primary-btn { background-color: #2D5016; color: white; }
                        .primary-btn:hover { background-color: #234011; }
                        .theme-select { padding: 12px 16px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Roboto', sans-serif; font-size: 16px; margin-right: 10px; background-color: white; }
                        .section-title { font-size: 18px; font-weight: 500; margin: 20px 0 15px 0; color: #444; display: flex; align-items: center; }
                        .section-title i { margin-right: 10px; color: #2D5016; }
                        .signature { margin-top: 60px; }
                        .controls-header { font-size: 20px; font-weight: 500; margin-bottom: 20px; color: #333; padding-bottom: 10px; border-bottom: 2px solid #f0f0f0; }
                    `;
                    break;
                    
                case 'miku':
                    headerGradient = 'linear-gradient(135deg, #33CCCC 0%, #299999 100%)';
                    css = `
                        body { font-family: 'Roboto', sans-serif; margin: 0; padding: 0; background-color: #f8f9fa; color: #333; }
                        .container { max-width: 800px; margin: 30px auto; box-shadow: 0 4px 20px rgba(0,0,0,0.1); border-radius: 12px; overflow: hidden; }
                        .header { background: ${headerGradient}; color: white; padding: 30px; text-align: center; position: relative; }
                        .header h1 { margin: 0; font-size: 28px; font-weight: 500; letter-spacing: 0.5px; }
                        .header p { margin: 10px 0 0 0; font-weight: 300; opacity: 0.9; }
                        .content { background-color: white; padding: 30px; line-height: 1.8; }
                        .content p { margin: 0 0 16px 0; }
                        .content table { width: 100%; margin-bottom: 16px; }
                        .content td { padding: 8px 0; }
                        .footer { background-color: white; padding: 40px 30px 30px 30px; text-align: right; border-top: 1px solid #eee; }
                        .material-card { background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); padding: 20px; margin-bottom: 20px; }
                        .controls { max-width: 800px; margin: 30px auto; padding: 20px; background-color: white; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
                        .form-group label { display: block; margin-bottom: 8px; font-weight: 500; color: #555; font-size: 14px; }
                        .form-group input, .form-group textarea { width: 100%; padding: 12px 16px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Roboto', sans-serif; font-size: 16px; transition: all 0.3s; }
                        .form-group input:focus, .form-group textarea:focus { outline: none; border-color: #33CCCC; box-shadow: 0 0 0 2px rgba(51, 204, 204, 0.2); }
                        .btn { padding: 12px 24px; border: none; border-radius: 8px; font-family: 'Roboto', sans-serif; font-size: 14px; font-weight: 500; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; transition: all 0.3s; box-shadow: 0 2px 5px rgba(0,0,0,0.2); margin-right: 10px; display: inline-flex; align-items: center; justify-content: center; }
                        .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.3); }
                        .primary-btn { background-color: #33CCCC; color: white; }
                        .primary-btn:hover { background-color: #2cbbbb; }
                        .theme-select { padding: 12px 16px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Roboto', sans-serif; font-size: 16px; margin-right: 10px; background-color: white; }
                        .section-title { font-size: 18px; font-weight: 500; margin: 20px 0 15px 0; color: #444; display: flex; align-items: center; }
                        .section-title i { margin-right: 10px; color: #33CCCC; }
                        .signature { margin-top: 60px; }
                        .controls-header { font-size: 20px; font-weight: 500; margin-bottom: 20px; color: #333; padding-bottom: 10px; border-bottom: 2px solid #f0f0f0; }
                    `;
                    break;
                    
                case 'elegant-purple':
                default:
                    headerGradient = 'linear-gradient(135deg, #6200ea 0%, #3700b3 100%)';
                    css = `
                        body { font-family: 'Roboto', sans-serif; margin: 0; padding: 0; background-color: #f5f7fa; color: #333; }
                        .container { max-width: 800px; margin: 30px auto; box-shadow: 0 4px 20px rgba(0,0,0,0.1); border-radius: 12px; overflow: hidden; }
                        .header { background: ${headerGradient}; color: white; padding: 30px; text-align: center; position: relative; }
                        .header h1 { margin: 0; font-size: 28px; font-weight: 500; letter-spacing: 0.5px; }
                        .header p { margin: 10px 0 0 0; font-weight: 300; opacity: 0.9; }
                        .content { background-color: white; padding: 30px; line-height: 1.8; }
                        .content p { margin: 0 0 16px 0; }
                        .content table { width: 100%; margin-bottom: 16px; }
                        .content td { padding: 8px 0; }
                        .footer { background-color: white; padding: 40px 30px 30px 30px; text-align: right; border-top: 1px solid #eee; }
                        .material-card { background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); padding: 20px; margin-bottom: 20px; }
                        .controls { max-width: 800px; margin: 30px auto; padding: 20px; background-color: white; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
                        .form-group label { display: block; margin-bottom: 8px; font-weight: 500; color: #555; font-size: 14px; }
                        .form-group input, .form-group textarea { width: 100%; padding: 12px 16px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Roboto', sans-serif; font-size: 16px; transition: all 0.3s; }
                        .form-group input:focus, .form-group textarea:focus { outline: none; border-color: #6200ea; box-shadow: 0 0 0 2px rgba(98, 0, 234, 0.2); }
                        .btn { padding: 12px 24px; border: none; border-radius: 8px; font-family: 'Roboto', sans-serif; font-size: 14px; font-weight: 500; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; transition: all 0.3s; box-shadow: 0 2px 5px rgba(0,0,0,0.2); margin-right: 10px; display: inline-flex; align-items: center; justify-content: center; }
                        .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.3); }
                        .primary-btn { background-color: #6200ea; color: white; }
                        .primary-btn:hover { background-color: #5a00d2; }
                        .theme-select { padding: 12px 16px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Roboto', sans-serif; font-size: 16px; margin-right: 10px; background-color: white; }
                        .section-title { font-size: 18px; font-weight: 500; margin: 20px 0 15px 0; color: #444; display: flex; align-items: center; }
                        .section-title i { margin-right: 10px; color: #6200ea; }
                        .signature { margin-top: 60px; }
                        .controls-header { font-size: 20px; font-weight: 500; margin-bottom: 20px; color: #333; padding-bottom: 10px; border-bottom: 2px solid #f0f0f0; }
                    `;
            }
            
            style.textContent = css;
            header.style.background = headerGradient;
        }

        // Download PDF
        document.getElementById('download-btn').addEventListener('click', function() {
            const element = document.getElementById('document');
            html2pdf().from(element).set({
                margin: 1,
                filename: 'undangan_karang_taruna.pdf',
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'cm', format: 'a4', orientation: 'portrait' }
            }).save();
        });

        // Download HTML
        document.getElementById('download-html-btn').addEventListener('click', function() {
            updateDocument();
            const htmlContent = document.documentElement.outerHTML;
            const blob = new Blob([htmlContent], {type: 'text/html'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'undangan_karang_taruna.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });

        // Apply theme
        document.getElementById('apply-btn').addEventListener('click', function() {
            applyTheme();
        });

        // Update document when form changes
        document.getElementById('judul').addEventListener('input', updateDocument);
        document.getElementById('dusun').addEventListener('input', updateDocument);
        document.getElementById('tanggal').addEventListener('input', updateDocument);
        document.getElementById('waktu').addEventListener('input', updateDocument);
        document.getElementById('tempat').addEventListener('input', updateDocument);
        document.getElementById('acara').addEventListener('input', updateDocument);
        document.getElementById('keterangan').addEventListener('input', updateDocument);
        document.getElementById('ttd').addEventListener('input', updateDocument);
        document.getElementById('namaTtd').addEventListener('input', updateDocument);

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateDocument();
            applyTheme();
        });
    </script>
</body>
</html>
